	\documentclass[12pt]{article} %{{{


% Text
\setlength{\marginparwidth}{2.3cm}

% Figures
\usepackage[margin=1in]{geometry}
\usepackage{graphicx}
\def\figdir{../Figs}

% define a command to setup the format of supporting infomration figures and tables.
% source: http://bytesizebio.net/2013/03/11/adding-supplementary-tables-and-figures-in-latex/
\newcommand{\beginsupplement}{%
        \setcounter{table}{0}
        \renewcommand{\thetable}{S\arabic{table}}%
        \setcounter{figure}{0}
        \renewcommand{\thefigure}{S\arabic{figure}}%
     }


% Math
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{newtxmath}
\DeclareMathAlphabet{\mathpzc}{T1}{pzc}{m}{it}
\DeclareMathOperator*{\argmin}{\arg\!\min}
\DeclareMathOperator*{\argmax}{\arg\!\max}
\usepackage{bm}
\def\tnull{{\text{null}}}
\def\vec#1{{\bm #1}}
\def\mat#1{\mathbf{#1}}


% abbreviations
\def\etal{\emph{et~al}.\ }
\def\eg{e.g.,~}
\def\ie{i.e.,~}
\def\cf{cf.\ }
\def\viz{viz.\ }
\def\vs{vs.\ }

% Refs
\usepackage[style=nature,
					backend=bibtex,
					sortcites=true,
					autocite=superscript
]{biblatex}
\addbibresource{mobility.bib}

\usepackage{url}

\usepackage{changepage}

% Figure caption
\usepackage{setspace}
\usepackage[font=small,labelfont=bf]{caption}
\captionsetup[subfigure]{font={bf,small}, skip=1pt, singlelinecheck=false}

\newcommand{\secref}[1]{Section~\ref{sec:#1}}
\newcommand{\figref}[1]{Fig.~\ref{fig:#1}}
\newcommand{\tabref}[1]{Table~\ref{tab:#1}}
%\newcommand{\eqnref}[1]{\eqref{eq:#1}}
%\newcommand{\thmref}[1]{Theorem~\ref{#1}}
%\newcommand{\prgref}[1]{Program~\ref{#1}}
%\newcommand{\algref}[1]{Algorithm~\ref{#1}}
%\newcommand{\clmref}[1]{Claim~\ref{#1}}
%\newcommand{\lemref}[1]{Lemma~\ref{#1}}
%\newcommand{\ptyref}[1]{Property~\ref{#1}}

% for quick author comments
\usepackage[usenames,dvipsnames,svgnames,table]{xcolor}
\definecolor{light-gray}{gray}{0.8}
\def\del#1{ {\color{light-gray}{#1}} }
\def\yy#1{ {\color{red}\textbf{yy: #1}} }
\def\dk#1{ {\color{red}\textbf{dk: #1}} }
\def\js#1{ {\color{red}\textbf{js: #1}} }


% CUSTOM MACROS

% Define the supporting information name
\def\SI{Supporting Information}

%}}}

\begin{document} %{{{
\title{Learning a functional distance between organizations with unsupervised embeddings of scientific mobility}
\title{Unsupervised embeddings of organizations capture the latent structure of global scientific mobility} %{{{
\date{\today}
\maketitle %}}}

%
% ABSTRACT
%

\begin{abstract}


Human mobility and migration drive major societal phenomena such as the growth and evolution of cities~\autocite{wef2017migration, curiel2018citygravity},  epidemics~\autocite{kraemer2020covid, truscott2012epidemicgravity, xia2005measlesgravity}, economies~\autocite{kaluza2010cargo, kerr2011immigration}, and innovation~\autocite{kaiser2018innovation, armano2017innovation, sugimoto2017mostimpact, petersen2018multiscale, franzoni2014advantage}.
Geographic distance and population have been considered as leading factors of human mobilit~\autocite{zipf1946gravity}.
However, geographic distance is becoming less relevant in the increasingly-globalized world~\autocite{czaika2018migration, czaika2018globalisation, buchan2009globalization, altbach2004globalization} in which physical barriers are shrinking while linguistic, cultural, and historical relationships are becoming more important, which calls for alternative \textit{functional distances} that take these factors into account~\autocite{boschma2005proximity,  brown1970functional, brown1970migration, kim2018functional}.
However, existing functional distance are often arbitrary and consider only single isolated facets of mobility.
Using the case study of scientific mobility, we demonstrate the a neural embedding model can successfully encode the affiliation trajectories of scientists into a vector-space representation of organizations~\autocite{mikolov2013word2vec} from which a functional distance can be derived.
We show that the proposed functional distance reflects the multi-faced structure of scientists' mobility that is not explained by geographic distance alone, capturing relations based on culture, language, and academic prestige at multiple levels of granularity.
The vector representations of organizations themselves also reveal insights into the landscape of global scientific mobility, such as a relationship between organizations' size and their connectedness that is consistent across most countries. 
The ability to learn scalable, dense, and meaningful high-resolution vector representations of mobility directly from the data can open up a new avenue of studying human mobility.

\end{abstract}



%
% INTRODUCTION
%
\section{Introduction}\label{sec:introduction} %{{{

% Introduce the question, why is it important?

How far apart are two places?
The question is surprisingly hard to answer when it involves human mobility.
Geographic distance has underpinned human movements, however it is becoming less relevant in a world connected by rapid transit and global airline networks.
For instance, a person living in Australia is more likely to migrate to the United Kingdom, a far-away country with similar language and culture, than to a much closer country such as Indonesia~\autocite{pew2018migration}.
Similarly, a student in South Korea is more likely to attend a university in Canada than one in North Korea~\autocite{unesco2019students}.
Although geographic distance has been used as the most prominent basis for models of mobility, such as the Gravity~\autocite{zipf1946gravity} and Radiation~\autocite{simini2012universal} models, there have been attempts to define alternative notions of distance, or ~\textit{functional distances}~\autocite{boschma2005proximity, brown1970functional, brown1970migration, kim2018functional} from real-world data or \textit{a priori} relationships between geographic entities.
Yet, functional distances are often low-resolution, at the level of countries rather than regions, cities, or organizations, and rely on somewhat arbitrary decisions about which factors are most relevant.
Moreover, functional distances have focused on only a single facet of mobility at a time, whereas real-world mobility is multi-faceted, influenced simultaneously by geography, language, culture, history, and economic opportunity.
To capture such complexity of human mobility, new approaches that incorporate its many facets into a single high-resolution functional distance are needed.

			
Here, we propose using a neural embedding model that draws from real-world mobility trajectories to encode the complex landscape of global mobility into a dense, continuous, and meaningful vector-space representation, from which a \textit{functional distance} between places is derived.
Using the case of scientific mobility, we demonstrate that the functional distance captures relations based on culture, language, and academic prestige, along with geographic relations, at multiple levels of granularity


Scientific mobility is a central driver of the increasingly-globalized scientific enterprise~\autocite{czaika2018globalisation, altbach2004globalization, box2008competition}, being strongly related to innovation~\autocite{braunerhjelm2020labor, kaiser2018innovation, armano2017innovation}, impact~\autocite{sugimoto2017mostimpact, petersen2018multiscale, franzoni2014advantage}, collaboration~\autocite{rodrigues2016mobility}, and the diffusion of knowledge~\autocite{braunerhjelm2020labor, azoulay2011diffusion, morgan2018prestige}.
Moreover, scientific mobility has known structure, such as the centrality of the United States and the United Kingdom, and the strong prestige hierarchy~\autocite{auriol2010careers, clauset2015hierarchy, deville2014career} that should be captured in a representation.
However, understandings of scientific mobility have been limited by the sheer scope and complexity of the phenomenon~\autocite{robinson2019mobility, vannoorden2012mobility, deville2014career, ackers2008mobility, scott2015dynamics}, being further confounded by the diminishing role of geography in shaping the landscape of scientific mobility.

Here, scientific mobility is operationalized using a researcher's organizational affiliations derived from their publication histories indexed in a comprehensive bibliographic database (see Methods).
The most fine-grained geographical unit in this data is the organization, such as a ``university'', ``research institute'', ``business'', or ``government agency''.
As a scientist's career progresses, they move between organizations or pick up additional (simultaneous) affiliations forming \textit{affiliation trajectories} (Fig.~\ref{fig:methods:mobility_sentence}).
Thus, the trajectories encode both migration and co-affiliation---the holding of multiple simultaneous co-affiliations involving the sharing of time and capital between locations---that is typical of scientific mobility~\autocite{rodrigues2016mobility, markova2016synchronous, sugimoto2017mostimpact} (see \SI).
We use the trajectories of more than three million name-disambiguated authors who were \textit{mobile}---having more than one affiliation---between 2008 and 2019, as evidenced by their publications indexed in the Web of Science database.


A vector-space embedding of organizations is learned by using affiliation trajectories as input to the standard skip-gram with negative sampling, or \textit{word2vec} neural-network architecture (see Methods).
This neural embedding model, originally designed for learning language models~\autocite{mikolov2013word2vec}, has been making breakthroughs by revealing novel insights into texts~\autocite{linzhuo2020hyperbolic, tshitoyan2019mat2vec, garg2018gender, kozlowski2018geometry, hamilton2016diachronic, le2014doc2vec, nakandala2016twitch} and networks~\autocite{perozzi2014deepwalk, grover2016node2vec}.
They are also computationally efficient, robust to noise, and can encode relations between entities as geomemetric relationships in the vector space~\autocite{levy2014neural, nakandala2017gendered, kozlowski2018geometry, an2018semaxis}.
In the organization embedding, each organization is encoded into a single vector, and vectors relate to one another based on the likelihood of organizations appearing adjacent to one another in the same affiliation trajectory.
The functional distance between two organizations is calculated as the cosine distance between their vectors, termed the \textit{embedding distance}.

%
% Figure - Example of mobility sentences
%
\begin{figure}[ht!]
    \centering
    \includegraphics[width=0.5\textwidth]{\figdir/mobility_example_combined.pdf}
    \caption{
        \textbf{Construction of affiliation trajectories from publication records}
        \textbf{a.}
        An author published five papers across five time periods, with only one affiliation listed in the byline of each paper.
        A unique identifier is assigned to each each organization and they are assembled into an affiliation trajectory ordered by year of publication.
        \textbf{b.}
        If an author lists multiple organization affiliations within the same year, then organization IDs within that year are placed in random order in each training iteration of the \textit{word2vec} model (for more detail, see \SI).
    }
    \label{fig:methods:mobility_sentence}
\end{figure}

To assess the performance of the embedding distance relative to geographic distance, we evaluate their correlation with real-world mobility data and their performance in predicting real-world mobility flows as parameters to the gravity model~\autocite{zipf1946gravity, barbosa2018human}.
The Gravity Model is a widely used mobility model~\autocite{curiel2018citygravity, lewer2008immigrationgravity, jung2008highwaygravity, hong2016busgravity, truscott2012epidemicgravity, xia2005measlesgravity} that calculates the \textit{expected flux}, $\hat{T}_{ij}$, of scientists between organizations based on their populations and distance:

\begin{equation}
	\label{eq:gravity_basic}
	\hat{T_{ij}} = Cm_{i}m_{j}f(r_{ij}),
\end{equation}
where $m_{i}$ is the population of mobile and non-mobile authors who affiliated with institution $i$, $f(r_{ij})$ is a decay function with respect to distance between organizations, and $C$ is a constant estimated from data (see Data and Methods). 
$\hat{T}_{ij}$, which is often referred to as ``expected flux''~\autocite{simini2012universal}, is the expected frequency of the co-occurrence of organizations $i$ and $j$ in the trajectory of affiliations in the gravity model.
The gravity model dictates that the expected flow, $\hat{T}_{ij}$, is symmetric (\ie $\hat{T}_{ij }= \hat{T}_{ji})$, is proportional to the organizations' sizes, $\hat{T}_{ij} \propto m_{i}, m_{j}$, and decays as a function of their distance, $f(r_{ij})$. 
We define the distance function in terms of either the geographic distance between organizations or their embedding distance.
For geographic distance, we define $f(r_{ij})$ as the standard power-law function, and for the embedding distance, we use the exponential function, selected as the best performing for each case (Fig.~\ref{fig:supp:predict_emb_bymodel} and Fig.~\ref{fig:supp:predict_geo_bymodel}).


%
% Subsection: Embedding performance
%
% TODO: remove the subsection label?
%
\subsection*{Embeddings provide functional distance between organizations}

The embedding distance correlates with and can be used to predict real-wold mobility flows better than geographic distance. 
The amount of variance in the expected flux explained by embedding distance ($R^{2} = 0.46$, Fig.~\ref{fig:gravity_performance}a) is more than twice that of geographic distance ($R^{2} = 0.22$, Fig.~\ref{fig:gravity_performance}b).
This pattern holds when considering the subset of only domestic (within-country organization pairs, Fig.~\ref{fig:supp:gravity_correlation}c) and only international mobility flows (across-country organization pairs, Fig.~\ref{fig:supp:gravity_correlation}d).
We fit the gravity model given by Eq.~\ref{eq:gravity_basic} (see Data and Methods) and computed the expected flux  $\hat{T}_{ij}$ using geographic distance and embedding distance as parameters.
The embedding distance produces better predictions of actual flux than does geographic distance (Fig.~\ref{fig:gravity_performance}c--d), which also holds for the subsets of only domestic (Fig.~\ref{fig:supp:gravity_correlation}e--f) and only international mobility (Fig.~\ref{fig:supp:gravity_correlation}g--h).
The embedding distance defined from the cosine distance between vectors also outperforms that defined from their dot product ($R^{2} = 0.34$, Fig.~\ref{fig:supp:gravity_dot}).
The embedding distance also out-performs alternative ``diffusion-based'' network distance measures such as the personalized-page rank scores (see \SI) calculated from the underlying mobility network (Fig.~\ref{fig:supp:gravity_pprcos}, Fig.~\ref{fig:supp:gravity_pprjsd}).
Our results unequivocally demonstrate that the embedding distance better captures actual mobility patterns than does geographic distance.


%
% Figure - Gravity law performance
%
\begin{figure}[h!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/GravityLawFig/gravity_performance.pdf}
	\caption{
		\textbf{Embedding distance outperforms geographic distance.}
		\textbf{a-b.} Embedding distance (cosine distance between organization vectors) better explains the expected flux between organization pairs than geographic distance.
		The red line is the line of the best fit.
		Black dots are mean flux across binned distances.
		99\% confidence intervals are plotted, but are too small to be visible.
		Correlation is calculated on the data in the $log$-$log$ scale. 
		The lightness of each hex bin indicates the frequency of organization pairs within it.
		\textbf{c-d.} Predictions of flux between organization pairs made using embedding distance outperform those made using geographic distance.
		Boxplots show distribution of actual flux for binned values of predicted flux.
		Box color corresponds to the degree to which the distribution overlaps with $y = x$;
		a perfect prediction yields all points on the black line.
		``RMSE'' is the root-mean-squared error between the actual and predicted values.
		\textbf{e-f.} Predictions made using model parameters learned from a subset of domestic (within-country) organization pairs.
		Embedding distance outperforms those made for geographic distance.
		\textbf{g-h.} Embedding distance also outperforms geographic distance when predicting flux using model parameters estimated from only international mobility (across-country organization pairs).
		Predictions of domestic and international mobility are qualitatively similar whether predicted using models with only within- or across-country pairs (\textbf{e-h}), or all organizations pairs (Fig. \ref{fig:supp:gravity_prediction_subsets}).
	}
	\label{fig:gravity_performance}
\end{figure}


\subsection*{Embeddings capture global structure of mobility}

The geometric space generated by the neural embedding methods sheds light on the multi-faceted relationships between organizations. To explore the topological structure of the embedding, we use a standard dimensionality reduction method (UMAP~\autocite{mcinnes2018umap}) to obtain a two-dimensional representation (Fig.~\ref{fig:projection}a).
By showing relationships between individual organizations, rather than aggregates such as nations or cities, this projection constitutes the largest and highest resolution ``map'' of scientific mobility to date.

Globally, the geographical constraints are conspicuous; organizations tend to form clusters based on their national affiliations and national clusters tend to be near their geographic neighbors.
At the same time, the embedding space also reflects a mix of geographic, historic, cultural, and linguistic relationships between regions much more clearly than alternative network representations (Fig.~\ref{fig:supp:network_vis}) that have been dominating studies of scientific mobility~\autocite{chinchilla2018global, czaika2018globalisation}.

The embedding space also allows us to \textit{zoom in} on subsets and re-project them using UMAP to reveal local relationships.
For example, re-projecting organizations located in Western, Southern, and Southeastern Asia (Fig.~\ref{fig:projection}b) reveals a gradient of countries between Egypt and the Philippines that largely corresponds to geography, but with some exceptions along the cultural and religious spectrums;
Iraq is nearer to Malaysia in southeast-Asian than closer and more religiously-similar Saudi Arabia and Qatar.
In fact, we compute the distance, $d$, between nations in the original embedding space as the cosine distance between the centroids of organizations vectors belonging to that country. 
Then, Malaysia ($d=0.29$) is closer to Iraq more than Arabia ($d=0.50$) and Qatar ($d=0.51$).
Linguistic and historical ties are also conspicuous.
We observe that Spanish-speaking post-colonial Latin American nations are positioned near Spain (Fig.~\ref{fig:projection}c), rather than nearby Portuguese-speaking nations ($d = 0.34$ vs. $d = 0.52$ for Mexico and $d = 0.39$ vs. $d = 0.49$ for Chile) reflecting linguistic and cultural ties.
Similarly, North-African countries that were once under French rule such as Morocco are closer to France ($d =0.35$) than to similarly-distant European countries such as Spain ($d = 0.40$) and Italy ($d = 0.53$).
Comparable structural patterns exist even within a single country.
For example, at the global level (Fig~\ref{fig:projection}a), organizations within Quebec in Canada are located nearer the French cluster ($d = 0.65$) than the rest of the Canadian organizations ($d = 0.88$).


Mirroring the global pattern, organizations in the United States are largely arranged according to geography (Fig.~\ref{fig:projection}d).
Re-projecting organizations located in Massachusetts (Fig.~\ref{fig:projection}e) reveals structure based on: urban centers (Boston vs. Worcester), organization type (e.g., hospitals vs. universities), and university systems (UMass vs. Harvard \& MIT).
For example, even though UMass Boston is located in Boston, it clusters with  other universities in the UMass System ($d = 0.34$) rather than the other typically more highly-ranked and research-focused universities in Boston ($d = 0.41$), implying a relative lack of mobility between the two systems.
Similar structures can be observed in other states such as among New York's CUNY and SUNY systems (Fig.~\ref{fig:supp:proj_newyork}), Pennsylvania's state system (Fig.~\ref{fig:supp:proj_pennsylvania}), Texas's Agricultural and Mechanical universities (Fig.~\ref{fig:supp:proj_texas}), and between the University of California and State University of California systems (Fig.~\ref{fig:supp:proj_california}).

\begin{figure}[hp!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/Projection/big_embedding_picture.pdf}
	\caption{
		\textbf{Projection of embedding space reveals complex multi-scale structure of organizations.}
		\textbf{a.}
		UMAP projection \autocite{mcinnes2018umap} of the embedding space reveals country-level clustering.
		Each point corresponds to an organization and its size indicates the average annual number of mobile and non-mobile authors affiliated with that organization from 2008 to 2019.
		Color indicates the region.
		\textbf{b.} Zooming into (re-projecting) the area containing countries in the Middle East and South and Southeast Asia shows a geographic and cultural gradient of country clusters.
		\textbf{c.} Similarly, zooming into the area organizations in Spain, Portugal, South, and Central America shows clustering by most widely-spoken majority language group--Spanish and Portuguese.
		\textbf{d.} Doing the same for organizations in the United States reveals geographic clustering based on state, roughly grouped by Census Bureau-designated regions,
		\textbf{e.} Zooming in further on Massachusetts reveals clustering based on urban center (Boston, Worcester), organizational sector (hospitals vs. universities), and university systems and prestige (UMass system vs. Harvard, MIT, etc.).
	}
	\label{fig:projection}
\end{figure}


Just as the embedding space makes it possible to ``zoom in'' on subsets of organizations, it is also possible to ``zoom out'' by aggregating organizational vectors.
We can examine the country-level structure that governs scientific mobility.
To this end, we define the representative vector of each country as the average of their organizational vectors.
We then perform hierarchical clustering of nations that have at least 25 organizations represented in the embedding space based on their cosine similarity, excluding the United States which is a dominant hub well connected to most other countries (see Fig. \ref{fig:clustering}a).
The six identified clusters roughly correspond to countries in East-Asia (orange), Scandinavia (dark purple), the British Commonwealth (light purple), and Central and Eastern Europe (light blue), and then two remaining diverse clusters contain a mix of European, Latin American, and Mediterranean countries.
The cluster structure shows that not only geography but also linguistic ties between countries are related to scientific mobility.

We quantify the relative importance of geography (by region), and language (by most widely-spoken language of each country) using the element-centric clustering similarity~\autocite{gates2019element}, a method that can compare hierarchical clustering by explicitly adjusting the relative importance of different levels of the hierarchy with scaling parameter $r$, acting like a ``zooming lens''.
If $r$ is high, the similarity is based on the lower levels of the dendrogram, whereas when $r$ is low, the similarity is based on higher levels.
Fig. \ref{fig:clustering}b demonstrates that the region plays a major role at higher levels of the clustering process (low $r$), and language (family) explains the clustering more at the lower levels (high $r$).
This suggests that the embedding space captures the hierarchical structure of mobility---at the highest level, geography defines the embedding space, followed by language.


%
% Figure - CLUSTERING
%
\begin{figure}[p!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/Clustering/cluster_country.pdf}
	\caption{
		\textbf{Geography, then language, conditions international mobility.}
		\textbf{a.} Hierarchically clustered similarity matrix of country vectors aggregated as the mean of all organization vectors within the country, excluding the United States and countries with less than or equal to 25 organizations.
		Color of matrix cells corresponds to the cosine similarity between country vectors.
		Color of country names corresponds to their cluster.
		Color of three cell rows separated from the matrix corresponds to, from left to right, the region of the country, the language family~\autocite{ethnologue}, and the individual language.
		\textbf{b.}	Element-centric cluster similarity~\autocite{gates2019element} reveals the factors dictating hierarchical clustering.
		Region better explains the grouping of country vectors at higher levels of the clustering.
		Language family, and then the most widely-spoken language, better explain the grouping of countries at more fine-grained level.
	}
	\label{fig:clustering}
\end{figure}



%
% Subsection - hierarchy
%
\subsection*{Embeddings capture latent prestige hierarchy}

Prestige hierarchy is known to underpin the dynamics of scientific mobility, where researchers tend to move to similar or less prestigious organizations~\autocite{deville2014career, clauset2015hierarchy}. Does the embedding space, to which no prestige information is given, encode a prestige hierarchy?
We test this by exploiting the geometric properties of the embedding space with SemAxis~\autocite{an2018semaxis}.
Here, we use SemAxis to operationalize the abstract notion of academic prestige, defining an axis in the embedding space where poles are defined using known high- and low-ranked universities.
To define prestige of ranked U.S. ranked univeristies, we use the Times Ranking of World Universities (we also use research impact from the Leiden Rankings~\autocite{waltman2012leidenrankings}, see \SI);
the high-rank pole is defined as the mean vector of the top five U.S. universities according to the rankings, whereas the low-ranked pole is defined using the five bottom-ranked (geographically-matched by U.S. census region) universities.
We derive an embedding-based ranking for universities based on their nearness to the high-ranked pole.

The embedding space encodes the prestige hierarchy of U.S. universities that are coherent with real-world university rankings.
The embedding-based ranking is strongly correlated with the Times ranking (Spearman's $\rho = 0.73$, Fig.~\ref{fig:semaxis}a).
For reference, the embedding-based ranking achieves correlation with the Times ranking comparable to that between the Times ranking and the publication impact scores from the Leiden Ranking~\autocite{waltman2012leidenrankings}, a bibliometrically-based university ranking (Spearman's $\rho = 0.87$, Fig.~\ref{fig:semaxis}b).
The correlation between the embedding-based ranking and the Times ranking is robust regardless of the number of organizations used to define the axes (Fig. SI~\ref{fig:supp:semaxis_compare}), such that even using only the single top-ranked and bottom-ranked universities produces a ranking that is significantly correlated with the Times ranking (Spearman's $\rho = 0.46$, Fig.~\ref{fig:supp:semaxis_compare}a).
The correlation is also comparable to network-driven measures such as degree strength (sum of edge weights, Spearman's $\rho = 0.73$) and eigenvector centrality (Spearman's $\rho = 0.76$, see \SI). 
The strongest outliers that were ranked more highly in the Times ranking than in the embedding-based ranking tend to be large state universities such as Arizona State University and  University of Florida.
Those ranked higher in the embedding based ranking tend to be relatively-small universities near major urban areas such as the University of San Francisco and University of Maryland Baltimore County.
This suggests that organizations in the embedding space are arranged according to prestige, even when the erepresentation is learned using data without explicit infomration on the direction of mobility (as in other formal models~\autocite{clauset2015hierarchy}), or prestige. 


The axes can further be visualized to examine the relative position of organizations along the prestige axis, and along a geographic axis between California and Massachusetts to aid visualization.
Prestigious universities such as Columbia, Stanford, MIT, Harvard, and Rockefeller are positioned towards the top of the axis (Fig.~\ref{fig:semaxis}c).
Universities at the bottom of this axis tend to be regional universities with lower national profiles (yet still ranked by Times Higher Education) and with more emphasis on teaching, such as Barry University and California State University at Long Beach.
By projecting other types of organizations onto the prestige axis, SemAxis offers a new means of reasoning about the prestige of organizations for which rankings are often low-resolution or incomplete, such as regional and liberal arts universities, seminaries, musical schools, and community colleges (Fig.~\ref{fig:semaxis}d), or for which no such rankings exist, such as government organizations (Fig.~\ref{fig:semaxis}d), and research institutes (Fig.~\ref{fig:semaxis}e).

%
% Figure - SemAxis results
%
\begin{figure}[hp!]
	\centering
	\includegraphics[width=0.7\textwidth]{\figdir/SemAxis/semaxis_fig.pdf}
	\caption{
		\textbf{Embedding captures latent geography and prestige hierarchy.}
		\textbf{a.} Comparison between the ranking of organizations by their rank in the Times ranking and the embedding rank derived using SemAxis pointing from the top five to geographically-matched bottom five universities ranked by the 2018 Times Higher Education ranking of U.S. Universities.
		Un-filled points are those top and bottom five universities used span the axis.
	  	Even when considering only a total of ten organization vectors, the estimate of the Spearman's rank correlation between the embedding and Times ranking is $\rho = 0.73$ ($n = 145$), which increases when more top-and-bottom ranked universities are included (Fig.~\ref{fig:supp:semaxis_compare}).
	  	\textbf{b.} Times ranking is correlated with Leiden Ranking of U.S. universities with Spearman's $\rho = 0.87$
		\textbf{c-f.} Illustration of SemAxis projection along two axes;  \textit{latent geographical axis}, from California to Massachusetts (left to right) and the \textit{prestige axis}.
		Shown for U.S. Universities (\textbf{c}), regional and liberal arts colleges (\textbf{d}), Research institutes (\textbf{e}), and Government organizations (\textbf{f}).
		Full organization names listed in Table~\ref{table:supp:orglabels}.
	}
	\label{fig:semaxis}
\end{figure}



We also find that the size (L2 norm) of the organization embedding vectors provides insights into the characteristics of organizations.
Up to a point (around 1,000 researchers), the size of U.S. organization's vectors tends to increase proportionally to the number of researchers (both mobile and non-mobile) within that organization with published work;
these organizations are primarily teaching-focused institutions, agencies, and hospitals that either are not ranked or have a low ranking.
However, at around 1,000 researchers, the size of the vector decreases as the number of researchers increases.
These organizations are primarily research-intensive and prestigious universities with higher rankings, research outputs, R\&D funding, and doctoral students (Fig.~\ref{fig:supp:length_vs_metaInfo}).
A similar pattern has been observed in applications of neural embedding to natural language, in which the size of word vectors was found to represent the word's specificity.
Roughly speaking, for word embeddings, the size of a vector indicates a specificity, i.e., the word associated with the vector frequently co-appears with particular context words\autocite{schakel2015measuring}. 
If the word in question is universal, appearing frequently in many different contexts, it would not have a large norm due to a lack of strong association with a particular context.
Likewise, an organization such as Harvard with a small norm appears in many contexts, alongside many different organizations in affiliation trajectories---it is well-connected.
The concavity emerges in part from the relationship between the size of the vector and the expected connectedness of the organization given its size (Fig.~\ref{fig:length}a, inset, $R^{2} = 0.17$).
Large, prestigious, and well-funded research universities such as Princeton and Harvard have smaller vector sizes because they appear in many different contexts compared to more teaching-focused organizations such as NY Medical College, and University of Michigan at Flint.
Some universities, such as the University of Alaska at Fairbanks, have considerably small vectors, which may be a result of its remote location and unique circumstances.


This find a similar convex-curve across many countries such as China, which closely mirrors that of the United States (Fig.~\ref{fig:length}b).
Smaller but scientifically advanced countries such as Australia, and other large populous countries such as Brazil exhibit curves similar to the United States (Fig.~\ref{fig:length}b, inset), though their exact position and size varies.
Other nations exhibit different curves, such as Egypt which has an``S''-shaped curve, meaning that their largest organizations are not as well connected as other countries' largest organizations. 
Similar patterns can be found across many of the 30 of the countries with the most total researchers (Fig.~\ref{fig:concave30}), however we can only speculate on what their variations mean (see \SI).
Neural embeddings encode a relationship between organization size and vector length that is universal across countries but with potentially meaningful nuances, helping the embedding to capture the landscape of global scientific mobility. 

%
% Figure - Boomerang
%
\begin{figure}[h!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/Math/boomerang.pdf}
	\caption{
		\textbf{Size of organization embedding vectors captures prestige and size of organizations.}
		\textbf{a.} Size (L2 norm) of organization embedding vectors compared to the number of researchers for U.S. universities.
		Color indicates the rank of the university from the Times ranking, with 1 being the highest ranked university.
		Uncolored points are universities not listed on a Times ranking.
		A convex-shape emerges, wherein larger universities tend to be more distant from the origin (large L2 norm); however, the more prestigious universities tend to have a small L2 norm.
		The L2 norm is correlated weakly with the ratio of organizations' number of connections (non-zero flows) to the number of researchers ($R^{2} = 0.17$, \textbf{inset}).
		The red line is the line of the best fit, and 99\% confidence intervals are shown, though are too small to be visible.
		\textbf{b.} We find a simliar convex-curve pattern across many countries such as the United States, China, Australia, Brazil, and others (\textit{inset}, and Fig.~\ref{fig:concave30}). 
		Some countries exhibit variants of this pattern, such as Egypt 's ``S''-shaped curve (\textbf{inset}).
		The loess regression lines are shown for each selected country, and for the aggregate of remaining countries, with 99\% confidence intervals.
		Loess lines are also shown for organizations in Australia, Brazil, and Egypt (\textbf{inset}).
	}
	\label{fig:length}
\end{figure}


%
% SECTION: CONCLUSION
%
\section*{Conclusion}

Neural embeddings offer a novel, data-driven solution for learning an effective and robust functional distance between places based on trajectory data, encoding the complex and multi-faceted nature of mobility.
We demonstrated how the embedding space encodes various aspects of scientific mobility, such as the global and regional geography, shared languages, and the hierarchy of organizational prestige, even without explicit information on these factors.


While scientific mobility is used as a case study, this approach may be broadly applicable to other kinds of mobility data, such as general human migration, transit-network mobility, and more.
Moreover, this approach can be used to learn a functional distance between entities for which no physical analog exists, such as between occupational categories based on individuals' career trajectories.
In addition to providing a functional distance that supports modeling and predicting mobility patterns, the structure of the neural embedding space is amenable to a range of unique applications for studying mobility.
As we have shown, the embedding space allows the visualization of the complex structure of scientific mobility at high resolution across multiple scales, providing a large and detailed map of the landscape of global scientific mobility.
SemAxis~\autocite{an2018semaxis} allows us to quantify abstract notions in mobility such as academic prestige, and can also be generalized to other abstract axes.
Investigation of the structure of the embedding space, such as the vector size, reveals unique and universal patterns based on organization's size and connectedness and could contribute to deeper understandings of scientific mobility.
Neural embedding opens the door for new approaches to represent and study scientific mobility, and also mobility more generally.



In spite of its promise, this approach and analysis has several limitations.
First, the current \textit{skip-gram word2vec} model can not encode directional information, meaning that embedding will be less effective at capturing mobility for which directionality is critical.
Second, the neural embedding approach is most useful in cases of mobility between discrete geographic units such as between countries, cities, and businesses; this approach is less useful in the case of mobility between locations represented using geographic coordinates, such as in the modeling of animal movements.
Neither of these methodological limitations is insurmountable, and future work can aim to incorporate directionality and identify meaningful representations of continuous mobility data.
Finally, the case of scientific mobility presents domain-specific limitations.
Reliance on bibliometric metadata means that we capture only long-term mobility such as migration, rather than the array or more frequent short-term mobility such as conference travel and temporary visits.
The kinds of mobility we do capture---migration and co-affiliation---are treated identically by our model although they are qualitatively different.
Also, our data might further suffer from survivorship bias: researchers at prestigious organizations tend to have more publications, leading to these organizations appearing more frequently in affiliation trajectories.


Mobility and migration are at the core of human nature and history~\autocite{shah2020migration}, driving societal phenomena as diverse as epidemics\autocite{kraemer2020covid, truscott2012epidemicgravity, xia2005measlesgravity} and science and innovation~\autocite{kaiser2018innovation, armano2017innovation, sugimoto2017mostimpact, petersen2018multiscale, franzoni2014advantage, morgan2018prestige, rodrigues2016mobility}.
However, the paradigm of scientific migration may be changing.
Traditional hubs of migration have experienced many politically-motivated policy changes that affect scientific mobility, such as travel restrictions in the U.S. and U.K.~\autocite{chinchilla2018travelban}.
At the same time, other nations, such as China, are growing into major scientific powers and attractors of talent~\autocite{tollefson2018china, cao2020returning}.
Unprecedented health crises such as the COVID-19 pandemic threaten to bring drastic global changes to travel and migration by tightening borders and halting travel.
With the changing paradigm of global mobility we need now, more than ever, new tools and approaches to capture and understand human mobility in order to inform sensible, effective, sustainable, and humane policies.

%
% DATA AND METHODS
%
\section*{Data and Methods}
\label{sec:datamethods} %{{{

Data, analysis, and associated code have been made publicly available and can be found at \url{https://github.com/murrayds/sci-mobility-emb}.

\subsection*{Data}
%% Main dataset
% Do we need to talk about how we define mobility in relation to past papers?
We source co-affiliation trajectories of authors from the Web of Science database hosted by the Center for Science and Technology Studies at Leiden University.
Trajectories are constructed from author affiliations listed on the byline of publications for a given author.
Given the limitations of author-name disambiguation, we limit our analyses to papers published after 2008, when the Web of Science began providing full names and institutional affiliations~\autocite{caron2014disambiguation} that improved disambiguation (see \SI).
This yields 33,934,672 author-affiliation combinations representing 12,963,792 authors.
Each author-affiliation combination is associated with the publication year and an ID linking it to one of 8,661 disambiguated organizational affiliations (see \SI for more detail).
Trajectories are represented as the list of author-affiliation combinations, ordered by year of publication, and randomly ordered for combinations within the same year.

Here, authors are classified as mobile when they have at least two distinct organization IDs in their trajectory, meaning that they have published using two or more distinct affiliations between 2008 and 2019.
Under this definition, mobile authors constitute 3,007,192 or 23.2 \% of all authors and 17,700,095 author-affiliation combinations.
Mobile authors were associated with 2.5 distinct organizational affiliations on average.
Rates of mobility differ across countries.
For example, France, Qatar, the USA, Iraq, and Luxembourg had the most mobile authors (Fig.~\ref{fig:supp:descriptives}c).
However, due to their size, the USA, accounted for nearly 40 \% of all mobile authors worldwide (Fig.~\ref{fig:supp:descriptives}a), with 10 countries accounting for 80 \% of all mobility (Fig.~\ref{fig:supp:descriptives}b).
The countries with the highest proportion of mobile scientists are France, Qatar, the United States, and Iraq, whereas those with the lowest are Jamaica, Serbia, Bosnia \& Herzegovina, and North Macedonia (Fig.~\ref{fig:supp:descriptives}c).
In most cases, countries with a high degree of inter-organization mobility also have a high degree of international mobility, indicating that a high proportion of their total mobility is international (Fig.~\ref{fig:supp:descriptives}d);
However, some countries such as France and the United States seem to have more domestic mobility than international mobility.
While the number of publications has increased year-to-year, the mobility and disciplinary makeup of the dataset has not significantly changed across the period of study (Fig.~\ref{fig:supp:pubs_over_time}).




\subsection*{Embedding}
%% Mobility sentences
We embed co-affiliation trajectories by treating them analogously to sentences and organizations analogously to words.
The trajectories of mobile authors were converted to ``affiliation trajectories'' by concatenating together their ordered list of unique organization identifiers, as demonstrated in Fig.~\ref{fig:methods:mobility_sentence}a.
In more complex cases, such as listing multiple affiliations on the same paper or publishing with different affiliations on multiple publications in the same year, the order is randomized within that year, as shown in  Fig.~\ref{fig:methods:mobility_sentence}b.

%% word2vec
These affiliation trajectories are used as input to the standard skip-gram negative sampling word embedding, commonly known as \textit{word2vec}~\autocite{mikolov2013word2vec}.
\textit{word2vec} constructs dense and continuous vector representations of words and phrases, in which distance between words corresponds to a notion of semantic distance. By embedding affiliation trajectories, we aim to learn a dense vector for every organization where the distance between vectors relates to the tendency for two organizations to occur in similar contexts.
Formally,  the model attempts to maximize average log probability of a target organization appearing in an affiliation trajectory $a_{t}$, given organizations in the surrounding context window, $a_{t+k}$. This can be written as follow, where $w$ is the size of the window and $T$ iterates through possible target organizations:

%
% MAIN W2V Equation
%
$$
\frac{1}{T}\sum_{t = 1}^{T} \sum_{-w \leq j \leq w, j \neq 0} \log p(a_{t + j} \vert a_{t}),
$$
where the conditional probability of observing one organization $a_{i}$, given another $a_{j}$, is defined as, 

%
% CONDITIONAL PROBABILITY EQ
%
$$
p(a_{i} \vert a_{j}) = \frac{\exp(\bm{u}_{a_{i}} \cdot \bm{v}_{a_{j}})}{\sum_{n=1}^N \exp(\bm{u}_{a_{n}} \cdot \bm{v}_{a_{j}})},
$$
where $N$ is the total number of organizations and $\bm{v}$ and $\bm{u}$ are the ``in-vector" and ``out-vector" respectively~\autocite{mikolov2013word2vec}.  We follow past studies and use the in-vector, $\bm{v}$, as the final representation~\autocite{linzhuo2020hyperbolic, tshitoyan2019mat2vec, garg2018gender, kozlowski2018geometry, hamilton2016diachronic, le2014doc2vec, nakandala2016twitch}.

%% Word2vec parameters and training procedure
We used the \texttt{gensim} python implementation of the \textit{word2vec} model. 
The skip-gram negative sampling  \textit{word2vec} model has several tunable hyper-parameters, including the embedding dimension $d$, the size of the context window $w$, the minimum frequency threshold $f_{\min}$, initial learning rate $\alpha$, and the number of iterations.
For main results, we used $d=300$ and $w=1$, which were the parameters that best explained the flux between organizations, though results were robust across different settings (Fig.~\ref{fig:supp:hyperparams}).
To mitigate the effect of less common organizations, we set the $f_{\min}$ as 50, limiting to organizations appearing at least 50 times across the training trajectories;
6,580 unique organizations appear in the resulting embedding.
We set $\alpha$ to its default value of 0.025 and iterate five times over all training affiliation trajectories.


%
% SUBSECTION: DISTANCE
%
\subsection*{Distance}
%% Distance calculations
$T_{ij}$ is the number of co-occurrences of organizations within author affiliation trajectories.
For example, $T_{ij} = 10$ indicates that ten authors were affiliated with both organization $i$ and $j$ between 2008 and 2019, as evidenced from their publications.
We treat all co-affiliations as symmetric, meaning that $T_{ij} = T_{ji}$.

We also calculate two forms of the distance between organizations.
The geographic distance, $g_{ij}$, is the pairwise geographic distance between organizations.
Geographic distance is calculated as the great circle distance, in kilometers, between pairs of organizations.
When less than one kilometer, a distance of 1 km is imputed.
The embedding distance with the cosine similarity, $d_{ij}$, is calculated as the pairwise cosine distance between vectors from the learned organization embedding, where $v_{i}$ and $v_{j}$ represent the vectors and $d_{ij} = 1 - \frac{\bm{v}_{i} \cdot \bm{v}_{j}}{\lVert \bm{v}_{i} \rVert \lVert \bm{v}_{j} \rVert}$.
Note that cosine distance derived from the embedding space is not a formal metric, as it does not satisfy the triangle inequality, however cosine distance have still proved practically useful across many tasks~\autocite{lerman2007embedding, brown1970migration, brown1970functional, kim2018functional}. 



%
% SUBSECTION: GRAVITY LAW
%
\subsection*{Gravity Law}

We model the flux of authors between organizations, $T_{ij}$, using the gravity law.
The gravity law of mobility loosely derives from the physical law of gravity, whereby the attraction between two objects is a function of their mass and the distance between them.
Given its simplicity and flexibility, this formulation and variants have proven incredibly useful for modeling and predicting many kinds of mobility~\autocite{jung2008highwaygravity, curiel2018citygravity, lewer2008immigrationgravity, xia2005measlesgravity, truscott2012epidemicgravity, hong2016busgravity}.
Following the gravity law, the \textit{expected flux} $\hat{T_{ij}}$ between two organizations is defined as follows,

%
% Gravity law EQ
%
\begin{equation}
	\label{eq:gravity_basic}
	\hat{T_{ij}} = Cm_{i}m_{j}f(r_{ij}),
\end{equation}
where $m_{i}$ and $m_{j}$ are the organization masses, or the yearly-average count of unique authors, both mobile and non-mobile, affiliated with each organization during the time window, and $f(r_{ij})$ is a distance-decaying function  between the two organizations. There are two popular forms of the $f(r_{ij})$. The first one is power-law function with $f(r_{ij})= r^{-\alpha}_{ij} \ (\alpha > 0)$, and the another one is exponential function with $f(r_{ij}) = e^{-\beta r_{ij}} \ (\beta > 0)$ \autocite{chen2015distance}.  
$f(r_{ij})$ and $C$ can be fit with the data.

We consider separate variants of $f(r_{ij})$ for geographic distance, $g_{ij}$, and the embedding distance, $d_{ij}$, report the best-fit model of each distance.
For geographic distance, we use the power-law function of the gravity law, with $f(g_{ij})= g^{-\alpha}_{ij}$, where $\alpha$ is estimated from the data.
For embedding distance, we use the exponential function, with $f(d_{ij}) = e^{-\beta d_{ij}}$, where $\beta$ is estimated from the data.
Following past studies~\autocite{simini2012universal}, parameters $C$, $\alpha$ and $\beta$ are estimated by log-transforming each variant of \ref{eq:gravity_basic}, obtaining Eq.~\ref{eq:linear_flux_geo} and Eq.~\ref{eq:linear_flux_emb} in the form of linear equations, and fitting parameters using linear regression \autocite{jung2008highwaygravity, curiel2018citygravity, lewer2008immigrationgravity, xia2005measlesgravity, truscott2012epidemicgravity, hong2016busgravity, simini2012universal}

\begin{equation}
	\label{eq:linear_flux_geo}
	\ln\frac{T_{ij}}{m_im_j} = \ln C  - \alpha \ln g_{ij},
\end{equation}

\begin{equation}
	\label{eq:linear_flux_emb}
	\ln\frac{T_{ij}}{m_im_j} = \ln C - \beta d_{ij},
\end{equation}
where $T_{ij}$ is the real flux from the dataset. The gravity law of mobility is known to be sensitive to the case where $T_{ij} = 0$, or zero movement between organizations.
Here, non-zero flows account for only 4.2 \% of all possible pairs of the 6,580 organizations represented in the embedding.
This value is comparable to other common applications of the gravity law, such as to phone calls, commuting, and migration \autocite{simini2012universal}.
We follow standard practice and exclude zero flows from our analysis.



%
% SUBSECTION: SEMAXIS
%
\subsection*{SemAxis}
SemAxis~\autocite{an2018semaxis, nakandala2017gendered, kozlowski2018geometry} is a technique that leverages the latent semantic characteristics of word embeddings to represent the position of terms along a conceptual axis, reflecting the relationship of these terms to a corresponding concept.
Each axis is an antonym pair defined for each specific use case.
In the case of natural language, the poles of the axis could be ``good'' and ``bad'', ``surprising'' and ``unsurprising'', or ``masculine'' and ``feminine''.
By treating organizations analogously to words and trajectories analogously to sentences, we can use SemAxis to leverage the semantic properties of the resulting embedding vectors to operationalize abstract relationships between organizations.

Let $S^+ = \{\bm{v}_1^+, \bm{v}_2^+ \cdots \bm{v}_n^+\}$ and $S^- =\{\bm{v}_1^-, \bm{v}_2^- \cdots \bm{v}_n^-\}$ be the set of positive and negative pole organization vectors respectively. Then, the average vectors of each set can be calculated as $\bm{V}^{+} = \frac{1}{n}\sum^n_1 \bm{v}_i^+$ and $\bm{V}^{-} = \frac{1}{n}\sum^n_1 \bm{v}_i^-$. From these average vectors of each set of poles, the semantic axis is defined as $\bm{V}_{\text{axis}} = \bm{V}^{+} - \bm{V}^{-}$. Then,  a score of organization $a$ is calculated as the cosine similarity of the organization's vector with the axis,

$$
score(a)_{\bm{V}_{\text{axis}}} = \cos(\bm{v}_{a}, \bm{V}_{\text{axis}}) = \frac{\bm{u}_{a} \cdot \bm{V}_{\text{axis}}}{\lVert \bm{v}_{a} \rVert \lVert \bm{V}_{\text{axis}} \rVert},
$$
where higher scores mean that organization $a$ is more closely aligned to $S^+$ than $S^-$.

We apply SemAxis to U.S. universities by defining two axes that capture geography and academic prestige, respectively.
The poles of the geographic axis are defined as the mean vector of all vectors corresponding to organizations in California, and then the mean of all vectors of organizations in Massachusetts.
For the prestige axis, we define a subset of top-ranked universities according to either the Times World University Rankings or based on the mean normalized research impact sourced from the Leiden Rankings.
The other end of the prestige axis is the geographically-matched (according to census region) set of universities ranked at the bottom of these rankings.
For example, if 20 top-ranked universities are selected and six of them are in the Northeastern United States, then the bottom six universities according to the same ranking will be included in the low-ranked subset.
From the prestige axis, we derive a ranking of universities that we then compare to other formal university rankings using Spearman rank correlation.



\clearpage
\beginsupplement
\section{Supporting Information}



%
%
\paragraph*{S1 Text}
\label{si:text:mobility_science}
{\bf Mobility and science.}

As scholars move, they bring their knowledge, their skills, and their social connections with them--collectively the movements of researchers shape the structure and direction of the global scientific enterprise.
For example, prestige-driven mobility between doctoral-granting and employing institution is highly unequal~\autocite{clauset2015hierarchy, deville2014career}, which impacts the diffusion of ideas across academia~\autocite{morgan2018prestige}.
By placing researchers in new social settings, mobility can lead to the formation of new collaborative relationships~\autocite{rodrigues2016mobility}, which in turn spur the further diffusion of knowledge and new innovations~\autocite{braunerhjelm2020labor, azoulay2011diffusion, kaiser2018innovation, armano2017innovation}.
Perhaps resulting from the selection effects of who gets to move, or the reconfiguring of social and epistemic networks, movement is associated with increased scientific impact~\autocite{sugimoto2017mostimpact, petersen2018multiscale, jonkers2013return, franzoni2014advantage}.
At the national level, the understanding of mobility has progressed beyond simplistic narratives of brain drain and brain gain, and instead adopts a new perspective of \textit{flows} of talent~\autocite{meyer2001network, ioannidis2014braindrain, gaillard1998circulation}.
Under this flow model, a mobile researcher is viewed as contributing to both their origin and destination countries, a perspective that fosters that is evidenced by the strong science of open countires~\autocite{wagner2017open}.
Perhaps because of these individual and national benefits, policy-makers have come to recognize the importance of global mobility~\autocite{box2008competition, oecd2010innovation}.
Movement is a key mechanism that has clear impacts on the composition and direction of the global scientific workforce and our collective scientific understanding.
Understanding the structure and dynamics of mobility is thus essential for understanding global science.


%
% S2 Text
\paragraph*{S2 Text}
\label{si:text:mobility_models}
{\bf Modeling scientific mobility.}

There are many ways of modeling scientific mobility from bibliographic data, the first consideration being the unit of analysis.
Most studies of mobility have focused on \textit{country-level} mobility--the flows of researchers across nations~\autocite{sugimoto2017mostimpact, scellato2015migrant, robinson-garcia2018indicators, franzoni2012foreign-born}.
Practically, country-level analyses benefit from higher reliability, such that idiosyncrasies and errors inherent to bibliographic databases are mitigated by this higher level of aggregation.
Epistemically, country-level analysis is useful for national science governance who aims to understand the status of their country in the global landscape and make informed policy decisions.
Analyses at lower levels of analysis are far less common.
\textit{Regional}-level scientific mobility--the flow of researchers between regions or cities within or across countries, has been only minimally studied~\autocite{vaccario2019mobility}, possibly due to lack of reliable long-term data and lack of policy relevance to national-level lawmakers.
\textit{Organization}-level mobility has the potential to inform institutional policy and to understand the composition of mobility within a single country or region, especially as it relates to organization performance, prestige, and inequality~\autocite{albarran2017topeconomic, deville2014career, morgan2018prestige, clauset2015hierarchy}.
However, affiliation disambiguation and noise in bibliometric data have makes large-scale organization-level analysis challenging.
Here, we learn neural-network embeddings of scientific mobility at the level of organizations using a curated bibliographic database.
These embeddings are robust to noise, and so are capable of representing clear structure even amid issues with organizational disambiguation.
In doing so, embeddings also capture a more detailed understanding of mobility than has been previously studied.


Another consideration when analyzing scientific mobility is what kinds of mobility to study.
Typical understandings of mobility are directional, meaning that movement is always \textit{from} one place and \textit{to} another.
Scientific mobility, however, is more complicated.
For example, scientists often hold multiple affiliations at a time~\autocite{markova2016synchronous}, listing them as co-affiliations on a single paper, or even choosing a subset of affiliations to use for multiple simultaneous projects~\autocite{robinson2019mobility}.
Even clearly-directional migration to another institution is complex--researchers may continue to publish with an old affiliation for projects that began before their move, and they may maintain social and organizational links to their old institution (e.g., collaborators, projects, graduate students) such that there is no clear breakage after migrating.
There is also a whole range of short-term scientific mobility, such as visiting scholarships and short-term visits that are only visible through intensive efforts such as manual extraction from CVs~\autocite{woolley2009cv, sandstrom2009cv, canibano2011temporary}.
Here, we focus on more long-term mobility that can be derived from bibliographic data.
Due to the complexity of scientific mobility, we make the simplifying assumption that all scientific mobility is \textit{symmetric} or without direction such that any move from an organization $A$ to organization $B$ is equivalent to a move from $B$ to $A$.
By assuming non-directional mobility, all mobility events are commensurate, meaning that they can be treated identically in our analysis--this allows us to represent the complexity of mobility without making decisions about the directional of their mobility or which is their main affiliation.
Moreover, this assumption has the practical advantage of matching the data format expected by the \textit{word2vec} model, as well as the theoretical advantage of adhering to the symmetricity assumption of the gravity model of mobility.



%
% S3 TEXT
\paragraph*{S3 Text}
\label{si:text:mobility_traj}
{\bf Building affiliation trajectories.}

We adopt a data-driven approach to constructing affiliation trajectories, making an as little adjustment to the raw bibliometric data as possible.
For each mobile researcher (having at least two distinct affiliations), we construct an affiliation trajectory based on the affiliations listed on their published papers indexed in the Web of Science database between 2008 and 2019.
An author is considered mobile if they published with at least two distinct affiliations during the time period of study.
Affiliations map to disambiguated organizations, each of which matches to a unique identifier.
Affiliations in a trajectory are first ordered by year of publication.
For example, if an author published with affiliation $A$ in $t_{0}$, affiliation $B$ in $t_{1}$, and $A$ again in $t_{2}$, then their ordered affiliation trajectory would be $\{A, B, C\}$.

In the case that multiple affiliations are used within a single year, affiliations listed on publications published in that year are shuffled between each stage of the \textit{word2vec} training process (each epoch).
For example, an author who published with affiliation $A$ in $t_{0}$, and affiliations $B, C$ in $t_{1}$ could appear as one of $\{A, B, C\}$ or $\{A, C, B\}$ in each training iteration.
This effectively removes the effect of order within a year, as the order cannot be meaningfully established based on co-affiliations in a single paper, or on different affiliations listed on separate papers, the publication of which is not necessarily representative of the actual completion of the project.

Other than restricting to only mobile researchers, we do not perform any filtering or reductions to affiliation trajectories.
For example, in the case than an author publishes with organization $A$ four times in $t_{0}$, and affiliation $B$ two times in $t_{1}$, then their trajectory will be $\{A, A, A, A, B, B\}$.
This means that mobile authors who publish more papers will have longer trajectories.
However, \textit{word2vec} will skip duplicate consecutive organization IDs, effectively eliminating the impact of these long repetitive trajectories.




%
% S4 TEXT
\paragraph*{S4 Text}
\label{si:text:ppr_dist}
{\bf Network-based personalized page rank distances.}


We also examine the gravity model on the Personalized Page Rank (PPR)\autocite{jeh2003scaling} as a benchmark on the network. We construct the co-occurrence network whose nodes are organization and edges are co-occurrence between two organizations. We use 0.9 in here.

\begin{equation}
	\label{eq:ppr}
	p_i = (1.0 - \alpha) v_i + \alpha p_i W,
\end{equation}

where $v_i$ is a vector with 1 in the ith entry, whose length is the N, the number of nodes in the network, W is the weighted adjacency matrix, and $\alpha$ is the hyper-parameter is called the teleportation parameter that controls the probability that random walker revisits the original node i. We can think of this PPR vector as a representation of a node, which is N-length embedding. For examining the gravity law, we use two distance measures for PPR. The first one is cosine distance which is used for our embedding method, and the second one is the Jensen–Shannon divergence (JSD).

\begin{equation}
	\label{eq:JSD}
	JSD(P||Q) = \frac{1}{2}D_{KL}(P||M) + \frac{1}{2}D_{KL}(Q||M),
\end{equation}

\begin{equation}
	\label{eq:KL}
	D_{KL} = \sum p(x)\log\frac{p(x)}{q(x)}
\end{equation}

where $M=\frac{1}{2}(P+Q)$. We report the both results, PPR with cosine distance (Fig. \ref{fig:supp:gravity_pprcos}) and (Fig. \ref{fig:supp:gravity_pprjsd}). In both cases, the performance is under the performance of the model with geographical distance. Even though the length of the PPR vectors is extremely larger than the length of our embedding vectors, our result on the embedding outperforms than network approach. Moreover, it is also computationally efficient and salable for large datasets.



%
% S5 TEXT
\paragraph*{S5 Text}
\label{si:text:organizations}
{\bf Organization disambiguation and metadata.}

Affiliations mapped to one of 8,661 organizations, disambiguated following that originally designed for the Leiden Rankings of World Universities~\autocite{waltman2012leidenrankings}.
Organizational records were associated with a full name, a type indicating the sector (e.g., University, Government, Industry), and an identifier for the country and city of the organization.
Sixteen different sector types were included in the analysis, which we aggregated to a four high-level codes: \textit{University}, \textit{Hospital}, \textit{Government}, and \textit{Other}.
Each record was also associated with a latitude and longitude, however, for many organizations, these were missing or incorrect. We manually updated the coordinates of 2,267 organizations by searching the institution name and city on Google Maps;
in cases where a precise location of the organization could not be identified, we used the coordinates returned when searching the name of the city.
The data was further enriched with country-level information, including region, majority language spoken, and language family of the majority language (e.g., the language family of \textit{Spanish} is \textit{Italic}).
State/province-level information was added using the reverse geocoding service LocationIQ using each organization's latitude and longitude as input.
Regional census classifications were also added for states in the United States.
For each organization, we also calculated size as the average number of unique authors (mobile and non-mobile) who published with that organization across each year of our dataset;
in the case that authors publish with multiple affiliations in a single year, they are counted towards each.


As a result of our disambiguation procedure, some affiliations are mapped to two organizations, one specific, and one more general.
For example, any author affiliated with ``Indiana University Bloomington'' will also be listed as being affiliated with the ``Indiana University System'', a more general designation for all public universities in Indiana.
However, a more general organization may not always occur alongside the more specific one.
For example, a researcher affiliated with the smaller regional school ``Indiana University South Bend'' will be listed as affiliated with only the ``Indiana University System''.
We identify all specific organizations that always co-occur along with a more general one.
For every career trajectory that includes one of these specific organizations, we remove all occurrences of the more general organization;
trajectories containing only a general designation are not altered.



%
% S6 TEXT
\paragraph*{S6 Text}
\label{si:text:disambiguation}
{\bf Author name dismabiguation.}

Author-name disambiguation, the problem of associating names on papers with individuals authors, remains difficult for the use of bibliometric data~\autocite{dangelo2020disambiguation}.
Authors in our dataset have been disambiguated using a rule-based algortihm that makes use of author and paper metadata, such as physica, addresses, co-authors, and journal, to score papers on the likelihood of belonging to an author cluster—a cluster of publications belived to have been authored by the same individual~\autocite{caron2014disambiguation}.
We limit our period of analysis until after 2008, as this is when the Web of Science began indexing additional author-level metadata such as full names and email addresses.
The disambiguation algorithm is conservative, favoring splitting clusters.
Past studies have validated this data, demonstrating it comparable to ground-truth records such as those from ORCID and useful for a wide range of bibliometric studies~\cite{sugimoto2017mostimpact, robinson2019mobility, chinchilla2018global, chinchilla2018travelban}.



%
% S7 TEXT
\paragraph*{S7 Text}
\label{si:text:network_ranking}
{\bf Reconstructing Times ranking with network measure.}

The performance of the embedding ranking in reconstructing the Times ranking is comparable to that of network-derived measures such as degree strength (Spearman's $\rho = 0.73$, Fig.~\ref{fig:supp:centrality_times_compare}a) and eigencentrality centrality (Spearman's $\rho = 0.76$, Fig.~\ref{fig:supp:centrality_times_compare}b).
However, while both embedding- and network-based measures relate to university prestige, they are qualitatively and quantitatively different.
The embedding-ranking of U.S. universities is less correlated with degree strength (Spearman's $\rho = 0.45$, Fig.~\ref{fig:supp:centrality_semaxis_compare}a) and eigenvector  centrality (Spearman's $\rho = 0.55$) than with the Times ranking itself (Spearman's $\rho = 0.73$, Fig.~\ref{fig:supp:centrality_semaxis_compare}b). 
The embedding ranking over-ranks large research-intensive universities such as North Carolina State University, University of Florida, and Texas A\&M University, whereas the network-derived ranking over-ranks smaller, more specialized universities such as Brandeis University, Yeshiva University, and University of San Francisco. 
This suggests that the embedding encodes information on prestige hierarchy at least as well as a network representation, but that the information encoded is something different from centrality


%
% S8 TEXT
\paragraph*{S8 Text}
\label{si:text:boomerang_speculation}
{\bf Speculation on variations of the convex-curve pattern.}

The convex-curve pattern observed in Fig.~\ref{fig:length} repeats across many countries, but with variations.
For example, the representative vector of Chinese organizations are larger than that of the United States ($\bar{l} = 2.97$ vs $\bar{l} = 2.39$, Table~\ref{table:supp:norm}),  causing its curve to be shifted upwards with a larger peak vector size;
this may reflect a tendency for organizations in the United States to appear more frequently in more different contexts than Chinese organizations.
Other nations such as Poland, Iran, and Turkey demonstrate a linear relationship between an organization's number of researchers and the vector size, indicating that their largest organizations belong to very specific contexts (Fig.~\ref{fig:concave30}).
The organization-level distribution of embedding vector norms reveals even deeper heterogeneity---
for example, whereas the United States has the smallest representative vector, skewness of the sizes of its organization vectors suggest that this is driven by a small number of especially-well-connected organizations ($s = -0.82$, Fig.~\ref{fig:norm_dist}).
Germany and the United Kingdom have comparable representative vector sizes to the United States ($\bar{l} = 2.6$ and $\bar{l} = 2.61$, respectively), though they are much less skewed ($s = -0.63$ and $s = -0.55$), suggesting less inequality in the connectedness of organizations in these countries.
The vector sizes of organizations in some countries are even more skewed, such as in Iran ($\bar{l} = 3.57$, $s = -2.13$), and China ($\bar{l} = 2.97$, $s = -1.08$), indicating the strong difference between their most- and least-connected organizations.
For some countries, their organizations are positively-skewed, though seemingly for different reasons---
Austria, for example, has a balanced distribution of organization vector sizes, suggesting a diverse range of organizations with most being well connected ($\bar{l} =2.64$, $s = 0.18$);
Russia, in contrast, has a high number of organization vectors of moderate size, but also several very isolated organizations with large vector sizes ($\bar{l} = 3.08$, $s = 0.67$).
By capturing the connectedness of organizations in the embedding vector size, the embedding space can be used to characterize universal and particularistic patterns of mobility across countries.


\newpage

% latex table generated in R 3.5.1 by xtable 1.8-2 package
% Thu Apr  2 13:43:00 2020
\begin{table}[ht]
\centering
\caption{\textbf{Full organization names}}
\label{table:supp:orglabels}
\begin{adjustwidth}{-2cm}{}
\begingroup\scriptsize
\begin{tabular}{llll}
  \hline
Short & Full & Short & Full \\
  \hline
Stanford & Stanford Univ & Northwestern & Northwestern Univ \\
  Columbia & Columbia Univ & Ball State & Ball State Univ \\
  Harvard & Harvard Univ & IU Bloomington & Indiana Univ, Bloomington \\
  UCLA & Univ of California, Los Angeles & Stevens Institute & Stevens Institute of Technology \\
  Cal State Long Beach & California State Univ, Long Beach & NJIT & New Jersey Institute of Technology \\
  Wright State & Wright State Univ & NYU & New York Univ \\
  U Toledo & Univ of Toledo & SUNY Albany & Univ at Albany, The State Univ of New York \\
  Boston U & Boston Univ & NY Medical College & New York Medical College \\
  Suffolk & Suffolk Univ & Miami University & Miami Univ \\
  CUNY & City Univ of New York (CUNY) & IU Pennsylvania & Indiana Univ of Pennsylvania \\
  U Arizona & Univ of Arizona & Baylor & Baylor College of Medicine \\
  OSU & Ohio State Univ & UT Health Center & Univ of Texas Health Science Center \\
  MIT & Massachusetts Institute of Technology & Bard College & Bard College \\
  Princeton & Princeton Univ & Stonehill College & Stonehill College \\
  GCU & Grand Canyon Univ & Carleton College & Carleton College \\
  Northcentral & Northcentral Univ & Hanover College & Hanover College \\
  UCSF & Univ of California, San Francisco & Queens College & Queens College \\
  Fielding & Fielding Graduate Univ & DePauw & DePauw College \\
  Pepperdine & Pepperdine Univ & Naval Academy & United States Naval Academy \\
  Argosy & Argosy Univ & Cal State San Marcos & California State Univeristy San Marcos \\
  Yale & Yale Univ & Broad Inst & Broad Institute \\
  U Hartford & Univ of Hartford & Forsyth Inst & Forsyth Institute \\
  FAU & Florida Atlantic Univ & U Alaska Museum & Univ of Alaska Museum of the North \\
  U Miami & Univ of Miami & Lawrence Berkeley & Lawrence Berkeley Natl Laboratory \\
  UWF & The Univ of West Florida & Allen Institute & Allen Institute for Brain Science \\
  FIT & Florida Institute of Technology & RTI International & RTI InterNatl \\
  Purdue & Purdue Univ, West Lafayette & Fermilab & Fermilab \\
  Notre Dame & Univ of Notre Dame & State of NY & State of New York \\
  Indiana State & Indiana State Univ & Mayo Clinic & Mayo Clinic \\
  Saint Mary's & Saint Mary's College & Fish and Wildlife & Fish and Wildlife Research Institute \\
  Tufts & Tufts Univ & EPA & United States Emvironmental Protection Agency \\
  Mattel & Mattel Children's Hospital & US Army & United States Army \\
  Clark & Clark Univ & NSF & Natl Science Foundation \\
  UMass Amherst & Univ of Massachusetts Amherst & US Navy & United States Navy \\
  Montclair & Montclair State Univ & US Air Force & United States Air Force \\
  Farleigh Dickinson & Fairleigh Dickinson Univ-Metro Campus & Ames Laboratory & Ames Laboratory \\
  Rockefeller & Rockefeller Univ & Olin College & Oin College of Engineering \\
  Adelphi & Adelphi Univ & Scripss Institute & Scripss Institute \\
  Barnard & Barnard College & Idaho Natl Lab & Idaho Natl Laboratory \\
  Saint John Fisher & Saint John Fisher College & Dana Faber & Dana Faber Cancer Institute \\
  U Penn & Univ of Pennsylvania & Dept of Agriculture & United States Department of Agriculture \\
  Villanova & Villanova Univ & DOE & United States Department of Energy \\
  Widener & Widener Univ-Main Campus & NIAMS & Natl Institute of Arthritis, Skin Diseases \\
  Robert Morris & Robert Morris Univ & JMI Labs & JMI Laboratories \\
  U Cincinnati & Univ of Cincinnati & Whitehead Inst & Whitehead Institute of Biomedical Research \\
  Case Western & Case Western Reserve Univ & Wellesley & Wellesley Univeristy \\
  Ashland & Ashland Univ & UT Health, San Antonio & Univ of Texas Health Science Center, San Antonio \\
  Texas A\&M & Texas A\&M Univ-Commerce & UNT & Univ of North Texas \\
  Texas Southern & Texas Southern Univ & UT Southwestern Med & Univ of Texas Southwestern Medical Center \\
  Baylor & Univ of Mary Hardin-Baylor & UT El Paso & Univ of Texas, El Paso \\
  U Washington & Univ of Washington - Seattle & USF & Univ of South Florida, Tampa \\
  Washington State & Washington State Univ & Florida A\&M & Florida Agricultural and Mechanical Univ \\
  Seattle Pacific & Seattle Pacific Univ & Barry & Barry Univ \\
  Cal State Fresno & California State Univ-Fresno & UMass Dartmouth & Univ of Massachusetts Dartmouth \\
  Northern Arizona & Northern Arizona Univ & Worcester Poly & Worcester Polytechnic Institute \\
  IUPUI & Indiana Univ - Purdue Univ Indianapolis & Umass Boston & Univ of Massachusetts Boston \\
  U Dayton & Univ of Dayton & MGH Inst & MGH Institute of Health Professions \\
  U Conn & Univ of Connecticut & Joseph W. Jones Center & Joseph W. Jones Ecological Research Center \\
  ASU & Arizona State Univ & Vaccine Research Center & Vaccine Research Center, San Diego \\
  U Florida & Univ of Florida & LA Ag Center & Lousianna Agricultural Center \\
  Northern Illinois & Northern Illinois Univ & FL Fish and Wildlife & Florida Fish and Wildlife Conservation Commission \\
  Condordia Chicago & Concordia Univ-Chicago & NHLBI & Natl Heart, Lung, and Blood Institute \\
  U Chicago & Univ of Chicago & NY Dept. of Health & New York Department of Health \\
  SIU Edwardsville & Southern Illinois Univ, Edwardsville & St Michaels & Saint Michaels College \\
  SIU Carbondale & Southern Illinois Univ, Carbondale &  &  \\
   \hline
\end{tabular}
\endgroup
\end{adjustwidth}
\end{table}


\newpage

\begin{table}[]
\centering
\caption{\textbf{L2 Norm of country's representative vectors}.
			 Shown for top 30 countries with the most unique mobile and non-mobile researchers}
\label{table:supp:norm}
\begin{tabular}{lrr}
\textbf{Country} & \textbf{L2 Norm} & \textbf{\# Organizations} \\ \hline
United States    & 2.39             & 1281                      \\
Germany          & 2.6              & 485                       \\
United Kingdom   & 2.61             & 514                       \\
Austria          & 2.64             & 74                        \\
France           & 2.83             & 688                       \\
Belgium          & 2.84             & 84                        \\
Switzerland      & 2.85             & 66                        \\
Spain            & 2.94             & 322                       \\
China            & 2.97             & 497                       \\
India            & 2.99             & 114                       \\
Poland           & 3.02             & 145                       \\
Canada           & 3.02             & 147                       \\
Italy            & 3.04             & 386                       \\
Russia           & 3.08             & 187                       \\
Norway           & 3.1              & 122                       \\
Netherlands      & 3.11             & 136                       \\
Sweden           & 3.16             & 75                        \\
Brazil           & 3.16             & 286                       \\
Finland          & 3.17             & 66                        \\
Denmark          & 3.21             & 54                        \\
Czech Republic   & 3.23             & 97                        \\
Greece           & 3.24             & 62                        \\
Australia        & 3.24             & 90                        \\
Turkey           & 3.28             & 99                        \\
South Korea      & 3.28             & 156                       \\
Israel           & 3.32             & 71                        \\
Portugal         & 3.33             & 57                        \\
Japan            & 3.35             & 465                       \\
Iran             & 3.57             & 68                        \\
Taiwan           & 3.67             & 72
\end{tabular}
\end{table}


\newpage

%
% Figure - publications over time
%
\begin{figure}[p!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/Descriptive/pubs_over_time.pdf}
	\caption{
		\textbf{Publications over time.}
		\textbf{a.}
		The number of papers published by mobile authors has been steadily increasing from 2008 to 2017, with a small decrease in 2018,  likely an artifact of the Web of Science indexing process.
		Lines correspond to publications by mobile authors (org, purple), by authors with affiliations in at least two cities (blue), at least two regions (green), and at least two countries (yellow).
		There is no evidence of major changes in the publication patterns of mobile authors during this time period.
		\textbf{b.}
		Lines correspond to the proportion of publications classified as Biology and Health (black), Physics and Engineering (purple), Life and Earth Science (magenta), Social Science and Humanities (orange), and Math and Computer Science (yellow).
		The rate of publication in Biology and Health has leveled since about 2013, whereas the rate of publication in other fields has steadily increased.
		\textbf{c.}
		Despite increasing absolute counts, the percentage of mobile scholars, and those with at least two city, regional, or country affiliations, as a proportion of all publications, has decreased over time.
		\textbf{d.}
		The proportion of authors' publications across fields has largely remained steady.
		Biology and Health Science has comprised the majority of publications across nearly all years but has steadily declined in proportion.
		However, the proportion of Social Science and Humanities publications has been steadily increasing.
	}
	\label{fig:supp:pubs_over_time}
\end{figure}



%
% Figure - descriptives
%
\begin{figure}[p!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/Descriptive/mobility_by_country.pdf}
	\caption{
		\textbf{Extent and nature of mobility by country.}
		\textbf{a.}
		The proportion of researchers in each country classified as mobile, meaning that they have at least two organization affiliations within the period of study.
		The countries with the most mobile researchers are the United States, China, France, Great Britain, and Germany.
		\textbf{b.}
		The same information, arranged into a cumulative distribution.
		The five countries with the highest mobility account for approximately 70 \% of all mobility.
		\textbf{c.} The proportion of researchers labeled as mobile by country.
		\textbf{d.} First two principal components of four variables: proportion in each country mobile across organizations, proportion mobile across cities, proportion mobile across regions, and proportion mobile across countries.
		The first component captures the overall degree of mobile, whereas the second compares within-country against across-country mobility.
	}
	\label{fig:supp:descriptives}
\end{figure}




\newpage
%
% Figure - reverse CDF by scale
%
\begin{figure}[p!]
	\centering
	\includegraphics[width=0.8\textwidth]{\figdir/Descriptive/rcdf_by_scale.pdf}
	\caption{
		\textbf{Reverse cumulative-distribution function of mobile authors by geographic scale.}
		\textbf{a.}
		The proportion of mobile authors by how many organizations are represented in their career trajectories.
		For example, for mobile authors, 100 \% of authors held an affiliation with at least two organizations, whereas about 35 \% were affiliated with 3 ore more organizations between 2008 and 2019.
		Mobile authors are defined as those with at least two distinct organizational affiliations represented in our data.
		\textbf{b.} 68 \% of mobile authors have at least two cities represented in their career trajectories.
		\textbf{c.} 45 \% of mobile authors have 2 or more regions represented in their career trajectories.
		\textbf{d.} Only 14 \% of mobile authors had 2 or more countries represented in their career trajectories.
	}
	\label{fig:supp:rcdf_by_scale}
\end{figure}




%
% Figure - Hyperparameter performance
%
\begin{figure}[p!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/Descriptive/hyperparameter_performance.pdf}
	\caption{
		\textbf{Larger dimensions, smaller window size improves embedding performance.}
		The correlation, or amount of flux explained by the embedding distance with varying skip-gram negative sampling hyperparameters.
		Window size refers to the window, on either side of the target token, to use as context for training.
		Smaller window sizes results in an embedding that explain more of the flux.
		Embedding dimensions refer to the size of the organization vector.
		Larger vectors perform better, though little difference between 200 and 300.
		All variants perform better on same-country pairs of organizations than on all organizations.
		All variants perform worse on different-country pairs on organizations.
		Larger embeddings outperform mid-size embeddings for the different-country case.
	}
	\label{fig:supp:cosdot}
\end{figure}


%
% Figure - Dot product and cosine similarity
%
\begin{figure}[p!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/Math/d300_ws1_dot_cosine.pdf}
	\caption{
		\textbf{Cosine distance is correlated with dot product similarity.}
		Calculated as the pairwise cosine distance (x-axis) and dot product similarity (y-axis) between organizational vectors.
		The two quantities are correlated with $R^{2} = 0.73$.
		Color indicates frequency of organizations in hex bin.
		Black dots are the mean dot product similarity for binned sets of embedding similarity and error bars correspond to 95\textsc{th} percentile confidence intervals.
		Red line is line of best fit.
	}
	\label{fig:supp:hyperparams}
\end{figure}



%
% Figure - Geographic predictions, by model
%
\begin{figure}[p!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/GravityLawFig/gravity_performance_geo_bymodel.pdf}
	\caption{
		\textbf{For geographic distance, the power-decay gravity model is better.}
		Predictions of flux between organization pairs made using geographic distance the exponential gravity model (top), and the power-law decay model (bottom).
		Boxplots show distribution of actual flux for binned values of predicted flux.
		Box color corresponds to the degree to which the distribution overlaps $x = y$.
		Shown using all pairs of organization (\textbf{a-b}), domestic (\textbf{c-d}), and international only (\textbf{e-f}) mobility.
		The power-decay model outperforms the exponential gravity model.
	}
	\label{fig:supp:predict_geo_bymodel}
\end{figure}



%
% Figure - Embedding predictions, by model
%
\begin{figure}[p!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/GravityLawFig/gravity_performance_emb_bymodel.pdf}
	\caption{
		\textbf{For embedding distance, the exponential gravity model is better.}
		Predictions of flux between organization pairs made using embedding distance the exponential gravity model (top), and the power-law decay model (bottom).
		Boxplots show distribution of actual flux for binned values of predicted flux.
		Box color corresponds to the degree to which the distribution overlaps $x = y$.
		Shown using all pairs of organization (\textbf{a-b}), domestic (\textbf{c-d}), and international only (\textbf{e-f}) mobility.
		The exponential gravity model out-performs the power-decay model.
	}
	\label{fig:supp:predict_emb_bymodel}
\end{figure}



%
% Figure - gravity correlation
%
\begin{figure}[p!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/GravityLawFig/gravity_correlations.pdf}
	\caption{
		\textbf{Embedding distance explains more variance for global, within, and between country flux than geographic distance.}
		\textbf{a.}
		Embedding distance (cosine distance between vectors) explains more of the total distance than does geographic distance (\textbf{b}).
		Red line is line of best fit.
		Black dots are mean flux across binned distances.
		Color indicates frequency of organization pairs within each hex bin.
		Results here are identical to those shown in Fig.~\ref{fig:gravity_performance}a and Fig.~\ref{fig:gravity_performance}.
		\textbf{c-d.}	embedding distance explains more variance when considering only pairs of organizations within the same country.
		\textbf{e-f.} embedding distance is more robust than geographic distance for pairs of organizations in different countries.
	}
	\label{fig:supp:gravity_correlation}
\end{figure}



%
% Figure - gravity predictions based on subset or global
%
\begin{figure}[p!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/GravityLawFig/gravity_different_fits.pdf}
	\caption{
		\textbf{Little difference between gravity predictions fit on all or subsets of data.}
		Predictions of flux between organization pairs made using embedding distance out-performs those made using geographic distance.
		Boxplots show distribution of actual flux for binned values of predicted flux.
		Box color corresponds to the degree to which the distribution overlaps $x = y$.
		\textbf{a-b.} Predictions are made with parameter, estimating parameters from all pairs of organizations, making global predictions (as in Fig.~\ref{fig:gravity_performance}c), and showing only subsets of predictions for organization pairs in the same country (\textbf{a}) and in different countries (\textbf{b}).
		\textbf{c-d.} Predictions made by estimating gravity law parameters on subset of organizations in the same country (\textbf{c}) and different country \textbf{d});
		this is the same data as shown in Fig.~\ref{fig:gravity_performance}f and Fig.~\ref{fig:gravity_performance}h.
	}
	\label{fig:supp:gravity_prediction_subsets}
\end{figure}



%
% Figure - Dot product distance
%
\begin{figure}[p!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/GravityLawFig/gravity_dot.pdf}
	\caption{
		\textbf{Examine gravity model with dot product on the embedding space.}
		Performance of dot product similarities in explaining and predicting mobility.
		Similarity scores are calculated as the pairwise dot product between organizational vectors.
		Dot product similarity performs better than geographic distance, though worse than cosine similarity in explaining global mobility (\textbf{a}), or domestic (\textbf{b}) or international (\textbf{c}) country mobility.
		Red line is line of best fit.
		Black dots are mean flux across binned distances.
		Color indicates frequency of organization pairs within each hex bin.
		Similarly, PPR distance performs comparably to geographic distance in predicting global (\textbf{d}), domestic (\textit{e}) and international (\textbf{f}) scientific mobility.
		Boxplots show distribution of actual flux for binned values of predicted flux.
		Box color corresponds to the degree to which the distribution overlaps $x = y$.
	}
	\label{fig:supp:gravity_dot}
\end{figure}




%
% Figure - PPR with COSINE DISTANCE gravity model and predictions
%
\begin{figure}[p!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/GravityLawFig/gravity_pprcos.pdf}
	\caption{
		\textbf{Personalized page rank with cosine distance.}
		Performance of personalized page rank scores in explaining and predicting mobility.
		Personalized page rank is calculated for the underlying mobility network, and distance measured as the cosine distnace between PPR probability distribution vectors.
		PPR cosine distance performs roughly similar to geographic distance in explaining global mobility (\textbf{a}), or domestic (\textbf{b}) or international (\textbf{c}) country mobility.
		Red line is line of best fit.
		Black dots are mean flux across binned distances.
		Color indicates frequency of organization pairs within each hex bin.
		Similarly, PPR distance performs comparably to geographic distance in predicting global (\textbf{d}), domestic (\textit{e}) and international (\textbf{f}) scientific mobility.
		Boxplots show distribution of actual flux for binned values of predicted flux.
		Box color corresponds to the degree to which the distribution overlaps $x = y$.
	}
	\label{fig:supp:gravity_pprcos}
\end{figure}


%
% Figure - PPR with JSD gravity model and predictions
%

\begin{figure}[p!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/GravityLawFig/gravity_pprjsd.pdf}
	\caption{
		\textbf{Personalized page rank with Jensen-Shannon Divergence.}
		Performance of personalized page rank scores in explaining and predicting mobility.
		Personalized page rank is calculated for the underlying mobility network, and distance measured as the Jensen-Shannon Divergence (JSD) between PPR probability distribution vectors.
		PPR JSD performs roughly similar to geographic distance in explaining global mobility (\textbf{a}), or domestic (\textbf{b}) or international (\textbf{c}) country mobility.
		Overall, PPR JSD explains more vairance in mobility than using cosine distance (Fig.~\ref{fig:supp:gravity_pprcos}), except for international mobility, for which cosine similarity out-performs JSD.
		Red line is line of best fit.
		Black dots are mean flux across binned distances.
		Color indicates frequency of organization pairs within each hex bin.
		Similarly, PPR JSD performs comparably to geographic distance in predicting global (\textbf{d}), domestic (\textit{e}) and international (\textbf{f}) scientific mobility.
		Boxplots show distribution of actual flux for binned values of predicted flux.
		Box color corresponds to the degree to which the distribution overlaps $x = y$.
	}
	\label{fig:supp:gravity_pprjsd}
\end{figure}


%
% Figure - Global Network Projection
%
\begin{figure}[hp!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/Projection/co_occur_with_label.pdf}
	\caption{
		\textbf{Visualization of global mobility network.}
		The network demonstrates country-level structure, but not at the detail or the extent of the global UMAP projection (Fig.~\ref{fig:projection}a).
		Each node corresponds to an organization, whereas  weighted edges (not shown) correspond to the flow of mobile researchers between the two organization.
		Nodes are colored by the country of the organization.
		Nodes are positioned using the force atlas layout algorithm.
	}
	\label{fig:supp:network_vis}
\end{figure}



%
% Figure - New York Projection
%
\begin{figure}[hp!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/Projection/umap_coordinate_region_New_York.pdf}
	\caption{
		\textbf{UMAP Projection of organizations in New York.}
		Each point corresponds to an organization and its size indicates the average annual number of mobile and non-mobile authors affiliated with that organization from 2008 to 2019.
		Color indicates the sector.
	}
	\label{fig:supp:proj_newyork}
\end{figure}


%
% Figure - Pennsylvania Projection
%
\begin{figure}[hp!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/Projection/umap_coordinate_region_Pennsylvania.pdf}
	\caption{
		\textbf{UMAP Projection of organizations in Pennsylvania.}
		UMAP projection of the embedding space of organizations in Pennsylvania reveal clustering based on geography, sector, and academic prestige.
		Each point corresponds to an organization and its size indicates the average annual number of mobile and non-mobile authors affiliated with that organization from 2008 to 2019.
		Color indicates the sector.
	}
	\label{fig:supp:proj_pennsylvania}
\end{figure}


%
% Figure - Texas Projection
%
\begin{figure}[hp!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/Projection/umap_coordinate_region_Texas.pdf}
	\caption{
		\textbf{UMAP Projection of organizations in Texas.}
		Each point corresponds to an organization and its size indicates the average annual number of mobile and non-mobile authors affiliated with that organization from 2008 to 2019.
		Color indicates the sector.
	}
	\label{fig:supp:proj_texas}
\end{figure}



%
% Figure - California Projection
%
\begin{figure}[hp!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/Projection/umap_coordinate_region_California.pdf}
	\caption{
		\textbf{UMAP Projection of organizations in California.}
		Each point corresponds to an organization and its size indicates the average annual number of mobile and non-mobile authors affiliated with that organization from 2008 to 2019.
		Color indicates the sector.
	}
	\label{fig:supp:proj_california}
\end{figure}




%
% Figure - SemAxis results
%
\begin{figure}[hp!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/SemAxis/semaxis_compare_fig.pdf}
	\caption{
		\textbf{SemRank hierarchy is robust.}
		\textbf{a.} Spearman's $rho$ (n = 143) between Times prestige rank and embedding rank derived using SemAxis, with poles defined using the top and bottom (geographically matched) ranked universities.
		Black points show spearman correlation using all organizations; white points show correlation using only universalizes not aggregated in the poles.
		Including more universities improves performance, but quickly saturates after around five universities.
		\textbf{b - f.} Comparison between the Times and SemAxis ranks of universities, by the number of universities used to define the poles (n).
		White points are those top and bottom 20 universities aggregated to define the ends of the axis.
		The grey box corresponds to the top 20 and bottom 20 ranks.
	  	Spearman's $\rho$ details the estimate from Spearman correlation between the two rankings using all universities, including those used to define the ends of each axis.
	}
	\label{fig:supp:semaxis_compare}
\end{figure}



%
% Figure - Network Centrality vs. Times
%
\begin{figure}[hp!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/SemAxis/centrality_times_compare.pdf}
	\caption{
		\textbf{Network centrality is strongly correlated with Times ranking.}
		Comparison between the ranking of organizations by their network-centrality rank and their rank in the 2018 Times Higher Education ranking of U.S. Universities .
		The Times rank is correlated with degree centrality rank (\textbf{a}) with a Spearman's $\rho = 0.73$, and is correlated with the eigenvector centrality rank (\textbf{b}) with a Spearman's $\rho = 0.76$.
	}
	\label{fig:supp:centrality_times_compare}
\end{figure}



%
% Figure - Network Centrality vs. SemAxis
%
\begin{figure}[hp!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/SemAxis/semaxis_network_compare.pdf}
	\caption{
		\textbf{Network centrality less correlated with Embedding rank.}
		Comparison between the ranking of organizations by their network-centrality rank and the embedding rank derived with SemAxis with poles defined using the top five to geographically-matched bottom five universities ranked by the 2018 Times Higher Education ranking of U.S. Universities .
		Embedding rank is correlated with degree centrality rank (\textbf{a}) with a Spearman's $\rho = 0.45$, and is correlated with the eigenvector centrality rank (\textbf{b}) with a Spearman's $\rho = 0.55$.
	}
	\label{fig:supp:centrality_semaxis_compare}
\end{figure}


%
% Figure - SemAxis By State
%
\begin{figure}[hp!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/SemAxis/semaxis_states_fig.pdf}
	\caption{
		\textbf{Geography and prestige SemAxis by U.S. state.}
		SemAxis projection along two axes, comparing California to Massachusetts universities (left to right), and between the top 20 and geographically-matched bottom 20 universities ranked by the 2018 Times Higher Education ranking of U.S. Universities (bottom to top).
		Points correspond to universities shown for California (\textbf{a}), Arizona (\textbf{b}), Washington (\textbf{c}), Massachusetts (\textbf{d}), Connecticut (\textbf{e}), New York (\textbf{f}), Texas (\textbf{g}), Pennsylvania (\textbf{h}), and Florida (\textbf{i}).
		Grey points correspond to all other U.S. universities.
		Full organization names listed in Table~\ref{table:supp:orglabels}.
	}
	\label{fig:supp:semaxis_states}
\end{figure}


%
% Figure - SemAxis By Sector
%
%\begin{figure}[hp!]
%	\centering
%	\includegraphics[width=\textwidth]{\figdir/SemAxis/semaxis_sectors_fig.pdf}
%	\caption{
%		\textbf{Geography and prestige SemAxis in U.S. by Sector.}
%		SemAxis projection along two axes, comparing California to Massachusetts universities (left to r%ight), and between the top 20 and geographically-matched bottom 20 universities ranked by the 2018 %Times Higher Education ranking of U.S. Universities (bottom to top).
%		Points correspond to organizations labeled as Government (\textbf{a}), Institute (\textbf{b}), and %Teaching (\textbf{c}), corresponding to government organizations, research institutes, and teaching o%rganizations, respectively.
%		Grey points correspond to all U.S. universities.
%	    	Full organization names listed in Table~\ref{table:supp:orglabels}.
%	}
%	\label{fig:supp:semaxis_sectors}
%\end{figure}



%
% Figure - length by factors
%
\begin{figure}[hp!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/Math/l2_org_meta.pdf}
	\caption{
		\textbf{Factors relating to the L2 norm of vectors for U.S. universities}
		Correlation between the L2 norm of organization embedding vectors of U.S. universities and characteristics of U.S. universities.
		Dots correspond to organizations.
		The red line is the line of  the best fit with corresponding 99\% confidence intervals.
		Red text is the regression estimate.
		The blue line is the loess regression line with 99\% confidence intervals.
		Number of authors is the average annual count of unique mobile and non-mobile authors.
		Rankings are derived from the Times Ranking of World Universities, and the Leiden Rankings of Universities.
		Remaining variables come from the Carnegie Classification of Higher Education Institutions.
		The factors that best explain $s_i$ are the number of authors, the rank, the amount of Science and Engineering (S\&E) funding, and the number of doctorates granted.
	}
	\label{fig:supp:length_vs_metaInfo}
\end{figure}



%
% Figure - Concave-curves countries
%
\begin{figure}[h!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/Math/boomerang_30_countries.pdf}
	\caption{
		\textbf{Concave-curve repeats across most of 30 countries with most researchers.}
		Size (L2 norm) of organization embedding vectors compared to their number of researchers for U.S. universities.
		Loess regression line is shown for each country with 99\% confidence intervals.
		Countries shown are the 30 with the largest number of total unique mobile and non-mobile researchers.
	}
	\label{fig:concave30}
\end{figure}



%
% Figure - Norm distribution by country
%
\begin{figure}[h!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/Math/l2_org_dist.pdf}
	\caption{
		\textbf{Distribution of organization embedding vector norms by country.}
		Histogram showing the distribution of L2 norm values of organization embedding vectors in each of the 30 countries with the largest number of total unique mobile and non-mobile researchers.
		Text in each panel shows the number of organizations in the country (n) and the GINI index of inequality of the distribution (g);
		a small GINI index indicates that the L2 norms of organizations are more balanced, whereas a high GINI value indicates that they are more unequal.
	}
	\label{fig:norm_dist}
\end{figure}






\clearpage
\printbibliography{}

\end{document} %}}}
