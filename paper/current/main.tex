	\documentclass[12pt]{article} %{{{


% Text
\setlength{\marginparwidth}{2.3cm}

% Figures
\usepackage[margin=1in]{geometry}
\usepackage{graphicx}
\def\figdir{../Figs}

% define a command to setup the format of supporting infomration figures and tables.
% source: http://bytesizebio.net/2013/03/11/adding-supplementary-tables-and-figures-in-latex/
\newcommand{\beginsupplement}{%
        \setcounter{table}{0}
        \renewcommand{\thetable}{S\arabic{table}}%
        \setcounter{figure}{0}
        \renewcommand{\thefigure}{S\arabic{figure}}%
     }


% Math
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{newtxmath}
\DeclareMathAlphabet{\mathpzc}{T1}{pzc}{m}{it}
\DeclareMathOperator*{\argmin}{\arg\!\min}
\DeclareMathOperator*{\argmax}{\arg\!\max}


% abbreviations
\def\etal{\emph{et~al}.\ }
\def\eg{e.g.,~}
\def\ie{i.e.,~}
\def\cf{cf.\ }
\def\viz{viz.\ }
\def\vs{vs.\ }

% Refs
\usepackage[style=nature,
					backend=bibtex,
					sortcites=true,
					autocite=superscript
]{biblatex}
\addbibresource{mobility.bib}

\usepackage{url}

\usepackage{changepage}

% Figure caption
\usepackage{setspace}
\usepackage[font=small,labelfont=bf]{caption}
\captionsetup[subfigure]{font={bf,small}, skip=1pt, singlelinecheck=false}

\newcommand{\secref}[1]{Section~\ref{sec:#1}}
\newcommand{\figref}[1]{Fig.~\ref{fig:#1}}
\newcommand{\tabref}[1]{Table~\ref{tab:#1}}
%\newcommand{\eqnref}[1]{\eqref{eq:#1}}
%\newcommand{\thmref}[1]{Theorem~\ref{#1}}
%\newcommand{\prgref}[1]{Program~\ref{#1}}
%\newcommand{\algref}[1]{Algorithm~\ref{#1}}
%\newcommand{\clmref}[1]{Claim~\ref{#1}}
%\newcommand{\lemref}[1]{Lemma~\ref{#1}}
%\newcommand{\ptyref}[1]{Property~\ref{#1}}

% for quick author comments
\usepackage[usenames,dvipsnames,svgnames,table]{xcolor}
\definecolor{light-gray}{gray}{0.8}
\def\del#1{ {\color{light-gray}{#1}} }
\def\yy#1{ {\color{red}\textbf{yy: #1}} }
\def\dk#1{ {\color{red}\textbf{dk: #1}} }
\def\js#1{ {\color{red}\textbf{js: #1}} }


% CUSTOM MACROS

%}}}

\begin{document} %{{{

\title{Unsupervised embeddings of organizations capture latent structure of scientific mobility} %{{{
\date{\today}
\maketitle %}}}

%
% ABSTRACT
%

\begin{abstract}

Scientific mobility drives innovation~\autocite{braunerhjelm2020labor, kaiser2018innovation, armano2017innovation}, impact~\autocite{sugimoto2017mostimpact, petersen2018multiscale, jonkers2013return, franzoni2014advantage}, collaboration~\autocite{rodrigues2016mobility}, and the diffusion of knowledge~\autocite{braunerhjelm2020labor, azoulay2011diffusion, morgan2018prestige}.
Common models of mobility, such as the Gravity Model~\autocite{zipf1946gravity, xia2005measlesgravity, jung2008highwaygravity, barbosa2018human, curiel2018citygravity, lewer2008immigrationgravity, hong2016busgravity, truscott2012epidemicgravity, xia2005measlesgravity, simini2012universal}, describes mobility using the \textit{distance} between places.
However, amid a globalizing scientific enterprise~\autocite{czaika2018globalisation}, geographic distance is losing its relevance for understanding mobility, whereas other abstract notions of distance~\autocite{boschma2005proximity} pose practical and theoretical challenges.
%Accordingly, the complexity of factors shaping global scientific mobility~\autocite{robinson2019mobility, vannoorden2012mobility, deville2014career, ackers2008mobility, scott2015dynamics} necessitates simplified models for reasoning about and crafting effective policy.
Leveraging the neural embedding model~\autocite{mikolov2013word2vec}, we demonstrate a data-driven approach for learning a vector-space representation that encodes an effective distance between places and captures the latent and multi-faceted structure of mobility.
We train scientific mobility embedding using the organizational trajectories derived from the publications of disambiguated authors from the Web of Science database between 2008 and 2019.
Distance between vectors in the learned embedding space explains and predicts mobility between organizations better than  geographic distance or network distance. We argue that such power emerges from an underlying connection between the neural embedding model and the gravity model.
In addition to geography, these embeddings also capture latent religious, cultural, social, and linguistic, and even prestige of organizations at multiple levels of granularity.
With this approach, we can learn scalable, dense, and meaningful vector representations of scientific mobility directly from the data using a methodology that can be easily applied to all kinds of mobility data.
\end{abstract}

%
% INTRODUCTION
%
\section{Introduction}\label{sec:introduction} %{{{

% Introduce the question, why is it important?

When scientists move, they bring their knowledge with them, and so understanding the flows of scientists allows us to understand the flow of knowledge around the world. 
However, given its complexity~\autocite{robinson2019mobility, vannoorden2012mobility, deville2014career, ackers2008mobility, scott2015dynamics}, new approaches are needed to make sense of landscape of global scientific mobility. 
A basic component of mobility is distance--people are more likely to move nearby than to cross continents.
Although many alternative ways to quantify the distance exist~\autocite{boschma2005proximity}, geographic distance remains the unambiguous and foundational quantity.
In turn, models of human mobility, such as the Gravity~\autocite{zipf1946gravity} and Radiation models ~\autocite{simini2012universal}, rely almost exclusively on geographic distance.
However, distance is not always so straightforward as simple geography. 
Geographic distance alone fails to capture the host of historical, linguistic, cultural, and cognitive distances that also drive mobility. 
For instance, Australia may be physically close to Indonesia, but in terms of language, history, and shared culture, they are essentially neighbors to the United Kingdom.
Then, how can we quantify meaningful, useful distance between institutions, cities, and countries?

Here, we propose a neural embedding model as an efficient means of encoding an effective measure of distance using large-scale data on mobility trajectories, one that encodes complex latent structure.
It has been demonstrated that the neural embedding model preserves semantic relationships between words in a dense, continuous and meaningful low-dimensional vector representation~\autocite{mikolov2013word2vec}, and has been applied to reveal insights in text~\autocite{linzhuo2020hyperbolic, tshitoyan2019mat2vec, garg2018gender, kozlowski2018geometry, hamilton2016diachronic}, documents~\autocite{le2014doc2vec, nakandala2016twitch}, and networks~\autocite{perozzi2014deepwalk, grover2016node2vec}.
In addition to encoding latent structure, this approach is computationally efficient, scalable for large datasets, robust to noise, and allows for a range of unique analyses that leverage their semantic properties using simple vector arithmetic.

As scientist's careers progress, they move between organizations or pick up additional affiliations, forming co-affiliation or \textit{mobility trajectories} that can be derived from their publication histories~\autocite{robinson2019mobility, sugimoto2017mostimpact}.
By treating geo-located organizations analogously to words and trajectories analogously to sentences, we learn vector-space embedding of organizations using a neural embedding method (Fig.~\ref{fig:methods:mobility_sentence}).
In the resulting embedding, each organization corresponds to a vector, and the \textit{cosine distance} between vectors represents the distance in the landscape of scientific mobility.

%
% Figure - Example of mobility sentences
%
\begin{figure}[ht!]
    \centering
    \includegraphics[width=\textwidth]{\figdir/mobility_example_combined.pdf}
    \caption{
        \textbf{Co-affiliation trajectories represented as sentences}
        \textbf{a.}
        An author published five papers across five time periods, with only one affiliation listed in the byline of each paper.
        To each organization, a unique identifier is assigned, and they are assembled into a mobility sentence ordered by year of publication.
        \textbf{b.}
        In a more complex case, an author lists several affiliations on the byline of papers in $t_{2}$, $t_{3}$, and $t_{4}$. 
        In the case where multiple organizations are listed within the same year, then organization IDs within a single year are randomized across each training iteration or "epoch" of the \textit{word2vec} model. 
    }
    \label{fig:methods:mobility_sentence}
\end{figure}


We use the trajectories of the three million name-disambiguated authors who were \textit{mobile}---having more than one affiliation---between 2008 and 2019, as evidenced by their publications indexed in the Web of Science database.
We adopt the Gravity Model of mobility~\autocite{zipf1946gravity, barbosa2018human}, one of the most broadly applied mobility models~\autocite{curiel2018citygravity, lewer2008immigrationgravity, jung2008highwaygravity, hong2016busgravity, truscott2012epidemicgravity, xia2005measlesgravity} to assess how well the embedding captures mobility. After fitting the parameters of the gravity model, we use it to derive the \textit{expected flux} $\hat{T_{ij}}$ between organizations, defined as,

\begin{equation}
	\label{eq:gravity_basic}
	\hat{T_{ij}} = Cm_{i}m_{j}f(r_{ij})
\end{equation}

Where the \textit{expected flux}, $\hat{T_{ij}}$, or expected number of authors co-affiliated with a pair organizations during the time period is proportional to the organization's sizes, $m_{i}$ and $m_{j}$, and decays as a function of their distance, $f(r_{ij})$.
We consider two distances, the geographic distance between the organizations as a baseline, and the \textit{embedding distance} defined as the cosine distance between the organization's vector in the trained embedding space.
We argue that the performance of a distance measure can be observed from their ability to explain expected mobility between organizations and to make predictions using the gravity model.
For geographic distance, we define $f(r_{ij})$ as the standard power-law function, and for the embedding distance, we use the exponential function, selected as the best performing for each case (Fig.~\ref{fig:supp:predict_emb_bymodel} and Fig.~\ref{fig:supp:predict_geo_bymodel}).


%
% Subsection: Embedding performance
%
\subsection*{Embeddings estimate the effective distance between organizations}

The effective distance estimated by our embedding model explains and predicts scientific mobility best.
The amount of variance explained by embedding distance ($R^{2} = 0.46$, Fig.~\ref{fig:gravity_performance}a) is more than twice that of geographic distance ($R^{2} = 0.22$, Fig.~\ref{fig:gravity_performance}b).
This pattern holds for the variance of only domestic (Fig.~\ref{fig:supp:gravity_correlation}c) and international mobility flows (Fig.~\ref{fig:supp:gravity_correlation}d).
After fitting model parameters from the data, the embedding distance produces better predictions of expected flux than does geographic distance globally (Fig.~\ref{fig:gravity_performance}c--d) and for domestic (Fig.~\ref{fig:supp:gravity_correlation}e--f) and international mobility(Fig.~\ref{fig:supp:gravity_correlation}g--h).
We also examine gravity model with dot product in the embedding space, the amount of variance explain ($R^{2} = 0.34$) by dot product outperforms that of geographic distance .
Similarly, embedding distance outperforms ``diffusion''  distances such as those derived from calculating personalized-page rank scores (see supporting materials) on the underlying mobility network (Fig.~\ref{fig:supp:gravity_pprcos}, Fig.~\ref{fig:supp:gravity_pprjsd}).
Geographic distance alone is a poor perspective for understanding international scientific mobility---rather, by learning a distance directly from the data, it is possible to better explain, and better predict flux between organizations.

%
% Figure - Gravity law performance
%
\begin{figure}[h!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/GravityLawFig/gravity_performance.pdf}
	\caption{
		\textbf{Embedding distance outperforms and is more robust than geographic distance.}
		\textbf{a.} embedding distance (cosine distance between organization vectors) explains more of the expected flux between organization pairs than does geographic distance (\textbf{b}).
		Red line is line of best fit.
		Black dots are mean flux across binned distances.
		Error bars are 99\% confidence intervals.
		Color indicates the frequency of organization pairs within each hex bin.
		\textbf{c-d.} Predictions of flux between organization pairs made using embedding distance outperform those made using geographic distance.
		Boxplots show distribution of actual flux for binned values of predicted flux.
		Box color corresponds to the degree to which the distribution overlaps $x = y$.
		``Err'' is calculated as the root-mean-squared error between the actual and predicted values.
		\textbf{e-f.} Predictions made using model parameters learned from a subset of domestic (within-country) organization pairs.
		Embedding distance outperforms those made for geographic distance.
		\textbf{g-h.} Embedding distance also outperforms geographic distance when predicting flux using model parameters estimated from only international mobility (across-country organization pairs).
		Predictions are not meaningfully different if estimates are learned on all pairs of organizations (Fig. \ref{fig:supp:gravity_prediction_subsets}).
		These predictions are robust whether the model is fit on the global data, or on the domestic (Fig.~\ref{fig:gravity_performance}e-h) or international Fig.~\ref{fig:supp:gravity_prediction_subsets}) subsets .
	}
	\label{fig:gravity_performance}
\end{figure}


%
% Subsection: Mathematical Exploration
%
\subsection*{Mathematical connection between gravity model and neural embedding }

Why does the word embedding model, originally designed for natural language processing, produce a reasonable distance that models gravity relationships between organizations?
We find evidence of a theoretical connection between the two models, one that makes the neural embedding model applicable to embedding many forms of mobility trajectories. For this section, we relax the cosine similarity as a dot product for simplicity.

According to our observation on the embedding space from Eq.\ref{eq:linear_flux_emb},

\begin{equation}
    \label{eq:gravity_model}
    \frac{T_{ij}}{M_{i} M_{j}} \propto \exp(-d_{ij}) =  \exp(- (-v_i \cdot v_j) \propto \exp(v_i \cdot v_j) 
\end{equation}
where $T_{ij}$ represents the \textbf{flux}, the number of people who moved between organizations $i$ and $j$,  $M_{i}$ and $M_{j}$ represent the size of an organization,  $d_{ij} = - v_{i}, v_{j}$ is the embedding distance.  In the case of scientific co-affiliation, we assume all movements are without direction (symmetric), meaning that  $T_{ij} = T_{ji}$. 


To rewrite  Eq.\ref{eq:gravity_model} in terms of $T_{ij}$, we replace  $M_i$ with $\mu_{i}$, the total flux to or from $i$ which can be written as

\begin{equation}
	\label{eq:approxi_mass_term}
    \mu_{i} = \sum_{k \in N} T_{ik} \propto M_i,
\end{equation}
where $N$ as set of organizations in the data. It can be checked in Fig.\ref{fig:math_part}. With this approximation, we can rewrite Eq.~\ref{eq:gravity_model} as,
\begin{equation}
   \frac{T_{ij}}{\mu_{i} \mu_{j}} \propto \exp(v_i,v_j).
\end{equation}



%
% Figure - Conditional Probability
%
\begin{figure}
    \centering
    \includegraphics[width=0.4\columnwidth]{\figdir/Math/m_and_M.pdf}
    \caption{
    Relationship between $M_i$ and $\mu_i$.}.
    \label{fig:math_part}
\end{figure}

This mathematical form relates to the objective function of the neural embedding model. The model attempts to maximize the average log probability of observing a target word in a sentence, $w_{t}$, given the words in the surrounding context window, $w_{t + k}$. This can be written as follows, where $c$ is the size of the context window and $T$ iterates through possible target words:

\begin{equation}
    \label{eq:skipgram_log_prob_condensed}
    \frac{1}{T}\sum_{t=1}^{T} \sum_{-c \le j \le c, j \neq 0} \log p(w_{t+j}|w_t),
\end{equation}
where the conditional probability of observing one word, $w_{O}$, given another, $w_{I}$, is defined as,

\begin{equation}
    \label{eq:skipgram_conditional_expanded}
    p(w_O|w_I) = \frac{\exp(v'_{w_O} \cdot v_{w_I})}{\sum_{w=1}^{W} \exp(v'_w \cdot v_{w_I})},
\end{equation}
where $v_w$ and $v'_w$ are ``input'' and ``output'' vector representations of each word in the vocabulary.  We use Skip-gram negative sampling model, and following the work by Levy and Goldberg \autocite{levy2014neural}, consider the model as implicitly performing matrix factorization as shown below,

\begin{equation}
    \label{eq:sgns_relation}
    A = \left(a_{ij}\right)_{W*W} = \log \left(\frac{N(i, j) |D|}{N(i) N(j)} \right) - \log k,
\end{equation}

where $N(i)\text{, } N(j) \text{ and } N(i,j)$ denotes the number of times word $i$, $j$, and word-context-pair ($i$, $j$) in the corpus respectively. Variable $k$ is the number of negative samples and $|D|$ is the size of the corpus. From Matrix Eq.\ref{eq:sgns_relation}, we can get embedding vector with rank-d approximation by SVD. The rank-d SVD factorize matrix A into product of three matrices  $L_d \Sigma R_d^T$, where $L_d$ and $R_d$ is $n \times d$ real matrices, and $\Sigma$ is    $d \times d$ diagonal matrix.

Mathematically, the maximization of the objective function of the model yields $A_d = L_d \Sigma R_d^T$ such that $A_d = \arg \ \min_{Rank(A')=d} \Vert A' - A  \Vert$, which is the best approximate of the original matrix $A$. If we set, $V=L_d \Sigma$ and $V'=R_d$, then dot product between the rows of $V$ are equal to the dot products between rows of $A_d$ because $V$ is orthogonal real matrix  \autocite{levy2014neural}. With this relationship, we can rewrite the equation in terms of $V$.  For a specific word pair $(i,j)$,

\begin{equation}
    \label{eq:sgns_relation_w,i, w_j}
    v_{i} \cdot v_{j} =  \log \left(\frac{N(i, j) |D|}{N(i) N(j)} \right) - \log k,
\end{equation}
where $|D|$ and $k$ are constants, such that the functional form can be re-written as,

\begin{equation}
    \label{eq:sgns_relation_w,i, w_j}
     \frac{N(i, j)}{N(i) N(j)}  \propto  \exp(v_{i} \cdot v_{j} ).
\end{equation}

In our model, $N(i)$ and $N(j)$ are total flux $M_i$ and $M_j$ respectively,  and $N(i,j)$ is just  $T_{ij}$, flux between $i$ and $j$. Then, we have the same expression with gravity model,

\begin{equation}
    \label{eq:sgns_relation_w,i, w_j_combining}
     \frac{T_{ij}}{\mu_{i} \mu_{j}}  \propto  \exp(v_{i} \cdot v_{j} ).
\end{equation}

This proportionality relationship is consistent with findings from our model, and so we can say that there is a mathematical link between the neural embedding model and the gravity model. Hence, the neural embedding model can be an effective model for investigating any kind of mobility trajectory data, stemming from the mathematical relationship between it and the gravity model of mobility.


%
% Subsection: Applications
%
\subsection*{Embeddings capture global structure of mobility}

Given that embeddings capture effective distance between organizations, we can now examine the global structure of scientific mobility.
Because the embeddings are defined in a high-dimensional space, we apply a widely-used dimensionality reduction technique (UMAP~\autocite{mcinnes2018umap}) to visualize the overall structure (Fig.~\ref{fig:projection}a).
Globally, the effect of geography is conspicuous; organizations tend to form clusters based on their national affiliations and national clusters tend to be near their geographic neighbors. 
At the same time, the embedding space also reflects a mix of geographic, historic, cultural, and linguistic relationships between regions.

By learning and leveraging the embedding space, these complex national and regional relationships can be quantified and visualized.  
For example, by re-projecting or \textit{zooming into} organizations located in Western, Southern, and Southeastern Asia (Fig.~\ref{fig:projection}b) reveals a gradient of countries from majority-Muslim countries in the Middle East to South Asian countries of Pakistan, Bangladesh, and Indonesia, and finally towards Southeast-Asian nations with different religious majorities such as Vietnam, the Philippines, and Thailand.
Linguistic and historical ties are also important.
For example, we observe that Spanish-speaking post-colonial Latin American nations (Mexico, Chile, Peru, etc.) are positioned near Spain, whereas Brazil is nearer to Portugal (Fig.~\ref{fig:projection}c).
Similarly, Algeria and Morocco are near the French cluster (Fig.~\ref{fig:projection}a).
Comparable structural patterns exist even within a single country.
For example, organizations within Quebec in Canada are located near the French cluster rather than the rest of Canada.

Just as the global embedding captures national-level geographic structure, so does a projection of organizations in the United States reflect organizational structure based on states (Fig.~\ref{fig:projection}d).
By re-projecting at the state-level for Massachusetts (Fig.~\ref{fig:projection}e), we observe structure between urban Centers (Boston vs. Worcester), but also based on organization type (e.g., hospitals vs. universities) and university systems.
Even though UMass Boston is located in Boston, it clusters near other universities in the UMass System rather than the typically more elite and research-focused universities in Boston, reflecting a relative lack of mobility between the two systems, even within the same state.
Similar structures can be observed in other states such as among New York's CUNY and SUNY systems (Fig.~\ref{fig:supp:proj_newyork}), Pennsylvania's state system (Fig.~\ref{fig:supp:proj_pennsylvania}), Texas's Agricultural and Mechanical universities(Fig.~\ref{fig:supp:proj_texas}), and between the University of California and State University of California systems (Fig.~\ref{fig:supp:proj_california}). 

\begin{figure}[hp!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/Projection/big_embedding_picture.pdf}
	\caption{
		\textbf{Projection of embedding demonstrates complex multi-scale structure.}
		\textbf{a.}
		UMAP projection \autocite{mcinnes2018umap} of the embedding space reveals strong country-level clustering.
		Each point corresponds to an organization and its size indicates the average annual number of mobile and non-mobile authors affiliated with that organization from 2008 to 2019. 
		Color indicates the continent.
		\textbf{b.} Zooming into (re-projecting) the area containing countries in the Middle East and South and Southeast Asia shows a geographic and cultural gradient of country clusters. 
		\textbf{c.} Similarly, zooming into the area organizations in Spain, Portugal, South and Central America show clustering by majority language group--Spanish and Portuguese.
		\textbf{d.} Doing the same for organizations in the United States reveals geographic clustering based on state, roughly grouped by Census Bureau-designated regions,
		\textbf{e.} Zooming in further on Massachusetts reveals clustering based on urban center (Boston, Worcester), organizational sector (hospitals vs. universities), and university systems and prestige (UMass system vs. Harvard, MIT, etc.).
	}
	\label{fig:projection}
\end{figure}

We can also examine high-level structure by estimating aggregate embeddings of countries. 
Namely, we calculate the representative vector of each country by averaging organization vectors within the given country.
We then perform hierarchical clustering of nations that have at least 25 organizations represented in the embedding space, excluding the United States which has high similarity with most other countries (see Fig. \ref{fig:clustering}a). 
The identified six clusters roughly correspond to: East-Asian (orange), Scandinavian (dark purple), British Commonwealth (light purple), Central and Eastern European countries (light blue), and then two cluster diverse clusters with a mix of European, Latin American, and Mediterranean countries.
Countries are either grouped geographically or by linguistic or historical ties. 

We investigate the extent to which geography and language dictate the formation of clusters using the element-centric clustering similarity~\autocite{gates2019element}, a method that can compare hierarchical clustering by explicitly adjusting the relative importance of different levels of the hierarchy with scaling parameter $r$, acting like a ``zooming lens''.
If $r$ is high, the similarity is based on the lower levels of the dendrogram, whereas when $r$ is low, similarity is based on higher levels.
Fig. \ref{fig:clustering}b demonstrates that continent plays a major role at higher levels of clustering process (low $r$), and language (family) explain the clustering more at the lower levels (high $r$).
This suggests that geography, then language, are important factors contributing to the structure of international scientific mobility.

%
% Figure - CLUSTERING
%
\begin{figure}[p!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/Clustering/cluster_country.pdf}
	\caption{
		\textbf{Geography, then language, dictate international mobility.}
		\textbf{a.} Hierarchically clustered similarity matrix of country vectors, aggregated as the mean of all organization vectors within the country that has a more than 25 organizations, excluding the United States.
		Color of matrix cells corresponds to similarity between country vectors.
		Color of country names corresponds to their cluster.
		Color of three cell rows separated from the matrix correspond to, from left to right, the continent of the country, the language family~\autocite{ethnologue}, and the individual language.
		\textbf{b.}	\textit{CluSim} \autocite{gates2019element} results demonstrating the factors dictating hierarchical clustering, varying by scaling parameter, $r$.
		Continent better explains the grouping of country vectors at higher levels of the clustering processes.
		Language family, and then majority spoken language, better explain the grouping of countries at more granular.
	}
	\label{fig:clustering}
\end{figure}


%
% Subsection - hierarchy
%
\subsection*{Embeddings capture latent geography and hierarchy}

The results demonstrating embeddings' ability to capture various features governing mobility raise the question of whether they can also capture semantic axes analogously to word embeddings. 
For instance, does the mobility embedding encode information about the prestige or universities?
In addition to encoding national characteristics, the embedding also encodes domestic geography and latent hierarchy.
Leveraging the unique semantic properties of the organization embedding, we employ the SemAxis approach~\autocite{an2018semaxis} and define two semantic axes.
The first is the California--Massachusetts axis defined by the mean vector of universities in California on one end, and in Massachusetts on the other. 
The second axis is the low- to high- prestige axis;
the elite end of the axis is defined as the top 20 U.S. universities according to the Times Ranking of World Universities, whereas the non-elite axis is defined as bottom-ranked and geographically matched (by U.S. census region) set of universities.
A university projected onto the axis corresponds to their nearness to the mean vector defining each pole (Fig.~\ref{fig:semaxis}a).


Generally, universities in Western states, such as Arizona (Fig.~\ref{fig:supp:semaxis_states}b) are nearer to the California end of the axis, whereas states in the Northeast such as New York (Fig.~\ref{fig:supp:semaxis_states}f) and Connecticut (Fig.~\ref{fig:supp:semaxis_states}e) are nearer the Massachusetts end.
Universities geographically distant from both California and Massahcussets are less aligned with either, such as Texas (Fig.~\ref{fig:supp:semaxis_states}g)s and Florida (Fig.~\ref{fig:supp:semaxis_states}i).


Universities hiring and mobility networks are known to exhbit latent pretige hierarchies ~\autocite{deville2014career, clauset2015hierarchy} that should be encoded in the embedding space.
Accordingly, prestigious universities such as Stanford, Colombia, MIT, Harvard, and NYU, group towards the top of the axis.
Universities at the bottom of this axis tend to be regional universities with lower national profiles.
By considering mobility between all organization types, organization embeddings offer a new means of reasoning about the prestige of organizations typically excluded from rankings such as government organizatioss (Fig.~\ref{fig:supp:semaxis_sectors}a), research institutes (Fig.~\ref{fig:supp:semaxis_sectors}b), and teaching colleges (Fig.~\ref{fig:supp:semaxis_sectors}c)

%
% Figure - SemAxis results
%
\begin{figure}[hp!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/SemAxis/semaxis_fig.pdf}
	\caption{
		\textbf{Embedding captures latent geography and prestige hierarchy.}
		\textbf{a.} illustrates SemAxis projection along two axes, comparing California to Massachusetts universities (left to right), and between the top 20 and geographically-matched bottom 20 universities ranked by the 2018 Times Higher Education ranking of U.S. Universities (bottom to top).
		Points correspond to organizations, and a sample of individual states are highlighted.
		Full organization names listed in Table~\ref{table:supp:orglabels}.
		\textbf{b.} Comparison between the ranking of organizations by their rank in the Times ranking and the SemAxis rank derived from the similarity to the \textit{Elite} end of the axis prestige axis \textit{a}.
		White points are those top and bottom 20 universities aggregated to define the ends of the axis.
		The grey box corresponds to the top 20 and bottom 20 ranks.
	  	The estimate of the spearman rank correlation between the SemAxis and Times ranking is 0.81 (n = 145).
	}
	\label{fig:semaxis}
\end{figure}

In addition to capturing geography, the word embedding also encodes the well-known latent prestige hierarchies of academic mobility~\autocite{deville2014career, clauset2015hierarchy}.
We derive a ranking using the prestige axis that we call \textit{SemRank}, and compare them to traditional university rankings.
SemRank is defined from the position of organizations along the prestige axis, with the top ranked being the furthest towards the \textit{Elite} end of the axis.
We find that SemRank derived is highly correlated with the Times ranking ($\rho = 0.81$, Fig.~\ref{fig:semaxis}b).
This correlation is robust with the number of organizations used to define the axes (Fig. SI~\ref{fig:supp:semaxis_compare}), such that even using only the single top-ranked and bottom-ranked universities is strongly correlated with the Times Ranking ($\rho = 0.46$, Fig.~\ref{fig:supp:semaxis_compare}a).
For reference, SemRank achieves correlation with the Times Ranking comparable to that between the Times ranking and the Leiden Ranking~\autocite{waltman2012leidenrankings}, a common and bibliometrically informed university ranking ($\rho = 0.87$, Fig.~\ref{fig:supp:times_vs_leiden}).
This suggests that word embeddings, in addition to learning the latent geography of mobility, also capture more nuanced characteristics such as latent hierarchy in the axis of the embedding, which is a unique and fascinating characteristic of this approach.


%
% SECTION: CONCLUSION
%
\section*{Conclusion}

By learning a distance directly from data, word embeddings successfully  and efficiently captures a robust measure of semantic distance between entities, all with existing tools and minor data processing.
This methodology is broadly applicable to studies of mobility.
Its success also points to the broad applicability of ideas from language and graph embedding techniques such as GLoVE~\autocite{pennington2014glove}, BERT~\autocite{devlin2018bert}, hyperbolic embeddings~\autocite{nickel2017poincare, linzhuo2020hyperbolic}, and persona2vec () to other problem domains, such as the social sciences.
In addition to their technical advantages and their unique suite of analytical tools, they are also readily transferable and can be trivially fit into a diverse array of analyses.

Globally, science has experienced many changes, from gradual globalization~\autocite{czaika2018globalisation} to the more sudden 2016 Brexit and 2017 U.S. travel bans, and more recently the Covid19 global pandemic.
The consequences of these changes are far-reaching, and how nations respond to them will shape the future of the scientific enterprise~\autocite{chinchilla2018travelban, wagner2017open, sugimoto2017mostimpact, whetsell2019democracy}.
Given mobility's importance, its vital that we gain a better understanding of where, how, and why researchers move, and what the impact of these movements will be.
With this new data-driven approach to learning distances relating to mobility, we capture the latent and nuanced structure of mobility at multiple scales;
with this, predictive models can be improved and new insights gained, which in turn will inform more effective science and immigration policy, allowing global science to dictate the terms and leverage the benefits of our own migrations.


%
% DATA AND METHODS
%
\section*{Data and Methods}
\label{sec:datamethods} %{{{

Data, analysis, and associated code have been made publicly available and can be found at \url{https://github.com/murrayds/sci-mobility-emb}

\subsection*{Data}
%% Main dataset
% Do we need to talk about how we define mobility in relation to past papers?
We source co-affiliation trajectories of authors from the Web of Science database hosted by the Center for Science and Technology Studies at Leiden University.
Trajectories are constructed from author affiliations listed on the byline of publications for a given author.
Given the limitations of author-name disambiguation, we limit to papers published after 2008, when the Web of Science began providing full names and institutional affiliations~\autocite{caron2014disambiguation} that improved disambigatuon (see supporting materials).
This yields 33,934,672 author-affiliation combinations representing 12,963,792 authors.
Each author-affiliation combination is associated with the publication year and an ID linking it to one of 8,661 a dismabiguated organizational affiliation (see supporting materials for more detail)
Trajectories are represented as the list of author-affiliation combinations, ordered by year of publication, and randomly ordered for combinations within the same year.

Scientific mobility is complex and can be defined in many possible ways~\autocite{robinson2019mobility} and at multiple levels of analysis.
Here, authors are classified as mobile when they have at least two distinct organization ids in their trajectory, meaning that they have published using two or more distinct affiliations between 2008 and 2019.
Under this definition, mobile authors constitute 3,007,192 or 23.2 percent of all authors, and 17,700,095 author-affiliation combinations.
Mobile authors were associated with, on average, 2.5 distinct organizational affiliations.
Rates of mobility tended to differ across country.
For example, France, Qatar, the USA, Iraq, and Luxembourg had the most mobile authors (Fig.~\ref{fig:supp:descriptives}c).
However, due to their size, the USA, accounted for nearly 40 percent of all mobile authors worldwide (Fig.~\ref{fig:supp:descriptives}a), with 10 countries accounting for 80 percent of all mobility (Fig.~\ref{fig:supp:descriptives}b).
In most cases, countries with a high degree inter-organization mobility also had a high degree of international mobility;
however, the USA and France had a high degree of inter-organization mobility with the corresponding international mobility (Fig.~\ref{fig:supp:descriptives}c).
While the number of publications has increased year-to-year, the mobility and disciplinary makeup of the dataset has not significantly changed across the period of study (Fig.~\ref{fig:supp:pubs_over_time}).



\subsection*{Embedding}
%% Mobility sentences
We embed co-affiliation trajectories by treating them analogously to sentences, and organizations analogously to words.
The trajectories of mobile authors were converted to ''mobility sentences`` by concatenating together their ordered list of unique organization identifiers, as demonstrated in Fig.~\ref{fig:methods:mobility_sentence}.a.
In more complex cases, such as listing multiple affiliations on the same paper or publishing with different affiliations on multiple affiliations in the same year, the order is randomized within that year, as shown in  Fig.~\ref{fig:methods:mobility_sentence}.b.

%% word2vec
These mobility sentences are used as input to the standard skip-gram negative sampling model, for word embedding, commonly known as \textit{word2vec}~\autocite{mikolov2013word2vec} .
In natural-language processing, word embeddings are used to construct dense vector-space representations of words and phrases, in which distance relationships between words correspond to a notion of semantic distance.
By embedding co-affiliation trajectories, we aim to learn a dense vector for every organization where distance between vectors relates to the tendency for two organizations to co-occur in a token window around the target term in the same career trajectory.
Vectors are learned by training a neural network to optimize the prediction of the so-called context term given a target, in our case using one organization to predict the others appearing in the same co-affiliation trajectory.
The hidden layer of the trained neural network is used as the

%% Word2vec parameters and training procedure
The skip-gram model has several tunable hyper-parameters, including the size of the learned vectors, the size of the token window  considered when training, the minimum frequency threshold for including an organization, and the number of iterations.
We iterate through several values of vector size and window size, repeating analysis for each combination.
To mitigate the effect of less common organizations, only organizations appearing at least 50 times in mobility sentences are included in the embedding;
this yields 6,580, or 76 percent of all organizations.
We iterate the skip-gram training for five epochs over all mobility sentences.
All word embeddings are trained using the \textit{gensim} python implementation of the skip-gram \textit{word2vec} model.
We visualize embeddings by projecting into two dimensions using UMAP~\autocite{mcinnes2018umap}.


Results are reported for embeddings with a dimensionality of 300 and a window size of one, which were the parameters that produced  that best explained the flux between organizations (Fig. SI~\ref{fig:supp:hyperparams}).
We note that this performance and the outcomes of analysis was robust to hyperparemeters settings.

In embedding space, we can consider two proximity measures: cosine similarity and dot product. Cosine similarity only consider about angle difference of two embedding vectors, while dot product cares about angle and magnitude at the same time. If vectors are normalized, they are the same. In general, which measure is good depends on the task. If the task is desirable to ignore the magnitude, then cosine similarity is better, otherwise, the dot product is better.



%
% SUBSECTION: DISTANCE
%
\subsection*{Distance}
%% Distance calculations
We calculate $T_{ij}$, the pairwise number of co-affiliations between organizations, calculated as the number of co-occurrences of organizations within author co-affiliation trajectories.
For example, $T_{ij} = 10$ indicates that ten authors were co-affiliated with both organization $i$ and $j$ between 2008 and 2019, as evidenced from their publications.
In contrast to traditional mobility studies, all co-affiliations are symmetric, meaning that $T_{ij} = T_{ji}$.

We also calculate two forms of distance between organizations.
The geographic distance, $g_{ij}$, is the pairwise geographic distance between organizations.
Geographic distance is calculated as the great circle distance, in kilometers, between pairs of organizations.
When less than one kilometer, a distance of one is imputed.
The embedding distance with the cosine similarity, $d_{ij}$, is calculated as the pairwise cosine distance between vectors from the learned organization embedding, where $v_{i}$ and $v_{j}$ represent the vectors and $d_{ij} = 1 - \frac{v_{i} \cdot v_{j}}{\lVert v_{i} \rVert \lVert v_{j} \rVert}$.
Additionally, the embedding distance with the dot product, we use  $d_{ij} =  -v_{i} \cdot v_{j}$.

%
% SUBSECTION: GRAVITY LAW
%
\subsection*{Gravity Law}

We model the flux of authors between organizations, $T_{ij}$, using the gravity law.
the gravity law of mobility loosely derives from the physical law of gravity, whereby the attraction between two objects is a function of their mass and the distance between them.
Given its simplicity and flexibility, this formulation and variants have proven incredibly useful for modeling and predicting many kinds of mobility~\autocite{jung2008highwaygravity, curiel2018citygravity, lewer2008immigrationgravity, xia2005measlesgravity, truscott2012epidemicgravity, hong2016busgravity}.
Following the gravity law, the \textit{expected flux} $\hat{T_{ij}}$ between two organizations is defined as follows,

\begin{equation}
	\label{eq:gravity_basic}
	\hat{T_{ij}} = Cm_{i}m_{j}f(r_{ij})
\end{equation}

where $m_{i}$ and $m_{j}$ are the yearly-average size of each organization during the time window, and $f(r_{ij})$ is a distance-decaying function  between the two organizations. There are two popular forms of the $f(r_{ij})$. The first one is power-law function with $f(r_{ij})= r^{-\alpha}_{ij}  (\alpha > 0)$, and the another one is exponential function with $f(r_{ij}) = e^{-\beta r_{ij}} (\beta > 0)$ \autocite{chen2015distance}.  $f(r_{ij})$, $C$ can be chosen as to fit the data with the simple regression.

We consider separate variants of $f(r_{ij})$ for geographic distance, $g_{ij}$, and the embedding distance, $d_{ij}$, report the best-fit model of each distance.
For geographic distance, we use the power-law function of the gravity law, with $f(g_{ij})= g^{-\alpha}_{ij}$, where $\alpha$ is estimated from the data.
For embedding distance , we use the exponential function, with $f(d_{ij}) = e^{-\beta d_{ij}}$, where $\beta$ is estimated from the data.
To estimate parameters $C$, $\alpha$ and $\beta$ are estimated by log-transforming each variant of \ref{eq:gravity_basic}, obtaining Eq.~\ref{eq:linear_flux_geo} and Eq.~\ref{eq:linear_flux_emb} in the form of linear equations, and fitting parameters using linear regression.


\begin{equation}
	\label{eq:linear_flux_geo}
	\ln(\frac{T_{ij}}{m_im_j}) = \ln(C)  - \alpha \ln(g_{ij})
\end{equation}

\begin{equation}
	\label{eq:linear_flux_emb}
	\ln(\frac{T_{ij}}{m_im_j}) = \ln(C) - \beta d_{ij}
\end{equation}

where $T_{ij}$ is the real flux from dataset. The gravity law of mobility is known to be sensitive to the case where $T_{ij} = 0$, or zero movement between organizations.
Here, non-zero flows account for only 4.2 percent of all possible pairs of  the 6,580 organizations represented in the embedding.
This value is comparable to other common applications of the gravity law, such as to hone calls, commuting, and migration \autocite{simini2012universal}.
We follow standard practice and exclude from our analysis zero flows.


%
% SUBSECTION: SEMAXIS
%
\subsection*{SemAxis}
By constructing semantic embeddings from mobility trajectories, we allow for unique methodology for understanding the embedding space, such as SemAxis.
SemAxis~\autocite{an2018semaxis} is a technique that leverages the latent semantic characteristics of word embeddings to represent the position of terms along a conceptual axis, reflecting the relationship of these term to the concept.
The precise axis is an antonym pair defined \textit{ad-hoc} for the specific use case.
In the case of language, the ends of the axis could be ``good'' and ``bad'', ``surprising'' and ``unsurprising'', or ``masculine'' and ``feminine''. It is shown that projection of words to given specific axis fit well with widely shared cultural connotation from surveyed
responses and labeled historical data \autocite{kozlowski2018geometry}.
In the case of scientific mobility, SemAxis offers a means of operationalizing abstract relationships between organizations.

Here, we apply SemAxis to U.S. universities by defining two axes, one of geography and one of academic prestige.
The poles of the geographic axis are defined as the mean vector of all vectors corresponding to organizations in California, and then the mean of all vectors of organizations in Massachusetts.
For the prestige axis, we define a subset of top-ranked universities according to either the Times World University Rankings or based on the mean normalized research impact sourced from the Leiden Rankings.
The other end of the prestige axis is the geographically-matched (according to census region) set of universities ranked at the bottom of these rankings.
For example, if 20 universities top-ranked universities are selected and six of them are in the Northeastern United States, then the bottom six universities according to the same ranking will be included in the low-ranked subset.
From the prestige axis we also derive what we call \textit{SemRank}, a university ranking based on the nearness of universities to the \textit{Elite} end of the axis.
We compare the SemAxis ranking to the traditional university rankings using Spearman rank correlations.


\clearpage
\beginsupplement
\section{Supporting Information}



%
%
\paragraph*{S1 Text}
\label{si:text:mobility_science}
{\bf Mobility and science.}
TODO: why is mobility important to science?


%
%
\paragraph*{S1 Text}
\label{si:text:mobility_models}
{\bf Modeling scientific mobility.}
There are many ways of modeling scientific mobility from bibliographic data, the first consideration being the unit of analysis. 
Most studies of mobility have focused on \textit{country-level} mobility--the flows of researchers across nations~\autocite{sugimoto2017mostimpact, scellato2015migrant, robinson-garcia2018indicators, franzoni2012foreign-born}.
Practically, country-level analyses benefit from higher reliability, such that such that idiosyncrasies and errors inherent to bibliographic databases are mitigated by this higher level of aggregation.
Epistemically, country-level analysis is useful for national science governance who aim to understand the status of their country in the global landscape and make informed policy decisions. 
Analyses at lower levels of analysis are far less common. 
\textit{Regional}-level scientific mobility--the flow of researchers between regions or cities within or across countries, has been only minimally studied~\autocite{vaccario2019mobility}, possibly due to lack of reliable long-term data and lack of policy relevance to national-level lawmakers. 
\textit{Organization}-level mobility has potential to inform institutional policy and for understand the composition of mobility within a single country or region, especially as it relates to organization performance, prestige, and inequality~\autocite{albarran2017topeconomic, deville2014career, morgan2018prestige, clauset2015hierarchy}.
However, affiliation disambiguation and noise in bibliometric data has makes large-scale organization-level analysis challenging.
Here, we learn neural-network embeddings of scientific mobility at the level of organizations using a curated bibliographic database.
These embeddings are robust to noise, and so are capable of representing clear structure even amid issues with organizational disambiguation. 
In doing so, embeddings also capture a more detailed understanding of mobility than has been previously studied. 

Another consideration when analyzing scientific mobility are what kinds of mobility to study. 
Typical understandings of mobility are directional, meaning that movement is always \textit{from} one place and \textit{to} another. 
Scientific mobility, however, is more complicated.
For example, scientists often hold multiple affiliations at a time~\autocite{markova2016synchronous}, listing them as co-affiliations on a single paper, or even choosing a subset of affiliations to use for multiple simultaneous projects~\autocite{robinson2019mobility}.
Even clearly-directional migration to another institution is complex--researchers may continue to publish with an old affiliation for projects that began before their move, and they may maintain social and organizational links  to their old institution (e.g., collaborators, projects, graduate students) such that there is no clear breakage after migrating. 
There are also a whole range of short-term scientific mobility, such as visiting scholarships and short-term visits that are only visible through intensive efforts such as manual extraction from CVs~\autocite{woolley2009cv, sandstrom2009cv, canibano2011temporary}.
Here, we focus on more long-term mobility that can be derived from bibliographic data. 
Due to the complexity of scientific mobility, we make the simplifying assumption that all scientific mobility is \textit{symmetric} or without direction such that any move from organization $A$ to organization $B$ is equivalent to a move from $B$ to $A$. 
By assuming non-directional mobility, all mobility events are commensurate, meaning that they can be treated identically in our analysis--this allows us to represent the complexity of mobility without making decisions for individual researcher's about the directional of their mobility or which is their main affiliation.
Moreover, this assumption has the practical advantage of matching the data format expected by the \textit{word2vec} model, as well as the theoretical advantage of adhering to the symmetricity assumption of the gravity model of mobility. 


%
% S1 TEXT
\paragraph*{S1 Text}
\label{si:text:mobility_traj}
{\bf Building mobility trajectories.}




For example, a researcher listing the set of affiliations $\{A, B, C\}$ on papers published in three different years will be considered two distinct instances of mobility, ${A \leftrightarrow B}$ and ${B \leftrightarrow C}$, where ${A \leftrightarrow B} = {B \leftrightarrow A}$ and  ${B \leftrightarrow C} = {C \leftrightarrow B}$. 




%
% S1 TEXT
\paragraph*{S1 Text}
\label{si:text:ppr_dist}
{\bf Network-based personalized page rank distances.}


We also examine the gravity model on the Personalized Page Rank (PPR)\autocite{jeh2003scaling} as a benchmark on the network. We construct the co-occurrence network whose nodes are organization and edges are co-occurrence between two organizations. We use 0.9 in here.

\begin{equation}
	\label{eq:ppr}
	p_i = (1.0 - \alpha) v_i + \alpha p_i W,
\end{equation}

where $v_i$ is a vector with 1 in the ith entry, whose length is the N, the number of nodes in the network, W is the weighted adjacency matrix, and $\alpha$ is the hyper-parameter is called the teleportation parameter that controls the probability that random walker revisits the original node i. We can think of this PPR vector as a representation of a node, which is N-length embedding. For examining the gravity law, we use two distance measures for PPR. The first one is cosine distance which is used for our embedding method, and the second one is the Jensen–Shannon divergence (JSD).

\begin{equation}
	\label{eq:JSD}
	JSD(P||Q) = \frac{1}{2}D_{KL}(P||M) + \frac{1}{2}D_{KL}(Q||M),
\end{equation}

\begin{equation}
	\label{eq:KL}
	D_{KL} = \sum p(x)\log(\frac{p(x)}{q(x)})
\end{equation}

where $M=\frac{1}{2}(P+Q)$. We report the both results, PPR with cosine distance (Fig. \ref{fig:supp:gravity_pprcos}) and (Fig. \ref{fig:supp:gravity_pprjsd}). In both cases, the performance is under the performance of the model with geographical distance. Even though the length of the PPR vectors is extremely larger than the length of our embedding vectors, our result on the embedding outperforms than network approach. Moreover, it is also computationally efficient and salable for large dataset.


%
% S2 TEXT
\paragraph*{S2 Text}
\label{si:text:organizations}
{\bf Organization disambiguation and metadata.}

Affiliations mapped to one of 8,661 organizations, disambiguated following that origionally designed for the Leiden Rankings of World Universities~\autocite{waltman2012leidenrankings}.
Organizational records were associated with a full name, a type indicating the sector (e.g., University, Government, Industry), and an identifier for the country and city of the organization.
Sixteen different sector types were included in the analysis, which we aggregated to a four high-level codes: \textit{University}, \textit{Hospital}, \textit{Government}, and \textit{Other}.
Each record was also associated with a latitude and longitude, however for many organizations these were missing or incorrect. We manually updated the coordinates of 2,267 organizations by searching the institution name and city on Google Maps;
in cases where a precise location of the organization could not be identified, we used the coordinates returned when searching the name of the city.
The data was further enriched with country-level information, including continent, majority language spoken, and language family of the majority language (e.g., the language family of \textit{Spanish} is \textit{Italic}).
State/province level  information were added using the reverse geocoding service LocationIQ using each organization's latitude and longitude as input.
Regional census classifications were also added for states in the United States.
For each organization, we also calculated a size as the average number of unique authors (mobile and non-mobile) who published with that organization across each year of our dataset;
in the case that authors publish with multiple affiliations in a single year, they are counted towards each.

As a result of our disambiguation procedure, some affiliations are mapped to two organizations, one specific, and one more general.
For example, any author affiliated with ``Indiana University Bloomington'' will also be listed as being affiliated with the ``Indiana University System'', a more general designation for all public universities in Indiana.
However, a more general organization may not always occur alongside the more specific one.
For example, a researcher affiliated with the smaller regional school ``Indiana University South Bend'' will be listed as affiliated with only the ``Indiana University System''.
We identify all specific organizations that always co-occur along a more general one.
For every career trajectory that includes one of these specific organizations, we remove all occurrences of the more general organization;
trajectories containing only a general designation are not altered.


%
% S3 TEXT
\paragraph*{S3 Text}
\label{si:text:disambiguation}
{\bf Author name dismabiguation.}

Author-name disambiguation, the problem of associating names on papers with individuals authors, remains difficult for the use of bibliometric data~\autocite{dangelo2020disambiguation}. 
Authors in our dataset have been disambiguated using a rule-based algortihm that makes use of author and paper metadata, such as physica, addresses, co-authors, and journal, to score papers on the likelihood of belonging to an author cluster—a cluster of publications belived to have been authored by the same individual~\autocite{caron2014disambiguation}. 
We limit our period of analysis until after 2008, as this is when the Web of Science began indexing additional author-level metadata such as full names and email addresses. 
The disambiguation algorithm is conservative, favoring splitting clusters. 
Past studies have validated this data, demonstrating it comparable to ground-truth records such as those from ORCID and useful for a wide range of bibliometric studies~\cite{sugimoto2017mostimpact, robinson2019mobility, chinchilla2018global, chinchilla2018travelban}.

\newpage

% latex table generated in R 3.5.1 by xtable 1.8-2 package
% Thu Apr  2 13:43:00 2020
\begin{table}[ht]
\centering
\caption{\textbf{Full organization names}}
\label{table:supp:orglabels}
\begin{adjustwidth}{-2cm}{}
\begingroup\scriptsize
\begin{tabular}{llll}
  \hline
Short & Full & Short & Full \\ 
  \hline
Stanford & Stanford Univ & Northwestern & Northwestern Univ \\ 
  Columbia & Columbia Univ & Ball State & Ball State Univ \\ 
  Harvard & Harvard Univ & IU Bloomington & Indiana Univ, Bloomington \\ 
  UCLA & Univ of California, Los Angeles & Stevens Institute & Stevens Institute of Technology \\ 
  Cal State Long Beach & California State Univ, Long Beach & NJIT & New Jersey Institute of Technology \\ 
  Wright State & Wright State Univ & NYU & New York Univ \\ 
  U Toledo & Univ of Toledo & SUNY Albany & Univ at Albany, The State Univ of New York \\ 
  Boston U & Boston Univ & NY Medical College & New York Medical College \\ 
  Suffolk & Suffolk Univ & Miami University & Miami Univ \\ 
  CUNY & City Univ of New York (CUNY) & IU Pennsylvania & Indiana Univ of Pennsylvania \\ 
  U Arizona & Univ of Arizona & Baylor & Baylor College of Medicine \\ 
  OSU & Ohio State Univ & UT Health Center & Univ of Texas Health Science Center \\ 
  MIT & Massachusetts Institute of Technology & Bard College & Bard College \\ 
  Princeton & Princeton Univ & Stonehill College & Stonehill College \\ 
  GCU & Grand Canyon Univ & Carleton College & Carleton College \\ 
  Northcentral & Northcentral Univ & Hanover College & Hanover College \\ 
  UCSF & Univ of California, San Francisco & Queens College & Queens College \\ 
  Fielding & Fielding Graduate Univ & DePauw & DePauw College \\ 
  Pepperdine & Pepperdine Univ & Naval Academy & United States Naval Academy \\ 
  Argosy & Argosy Univ & Cal State San Marcos & California State Univeristy San Marcos \\ 
  Yale & Yale Univ & Broad Inst & Broad Institute \\ 
  U Hartford & Univ of Hartford & Forsyth Inst & Forsyth Institute \\ 
  FAU & Florida Atlantic Univ & U Alaska Museum & Univ of Alaska Museum of the North \\ 
  U Miami & Univ of Miami & Lawrence Berkeley & Lawrence Berkeley Natl Laboratory \\ 
  UWF & The Univ of West Florida & Allen Institute & Allen Institute for Brain Science \\ 
  FIT & Florida Institute of Technology & RTI International & RTI InterNatl \\ 
  Purdue & Purdue Univ, West Lafayette & Fermilab & Fermilab \\ 
  Notre Dame & Univ of Notre Dame & State of NY & State of New York \\ 
  Indiana State & Indiana State Univ & Mayo Clinic & Mayo Clinic \\ 
  Saint Mary's & Saint Mary's College & Fish and Wildlife & Fish and Wildlife Research Institute \\ 
  Tufts & Tufts Univ & EPA & United States Emvironmental Protection Agency \\ 
  Mattel & Mattel Children's Hospital & US Army & United States Army \\ 
  Clark & Clark Univ & NSF & Natl Science Foundation \\ 
  UMass Amherst & Univ of Massachusetts Amherst & US Navy & United States Navy \\ 
  Montclair & Montclair State Univ & US Air Force & United States Air Force \\ 
  Farleigh Dickinson & Fairleigh Dickinson Univ-Metro Campus & Ames Laboratory & Ames Laboratory \\ 
  Rockefeller & Rockefeller Univ & Olin College & Oin College of Engineering \\ 
  Adelphi & Adelphi Univ & Scripss Institute & Scripss Institute \\ 
  Barnard & Barnard College & Idaho Natl Lab & Idaho Natl Laboratory \\ 
  Saint John Fisher & Saint John Fisher College & Dana Faber & Dana Faber Cancer Institute \\ 
  U Penn & Univ of Pennsylvania & Dept of Agriculture & United States Department of Agriculture \\ 
  Villanova & Villanova Univ & DOE & United States Department of Energy \\ 
  Widener & Widener Univ-Main Campus & NIAMS & Natl Institute of Arthritis, Skin Diseases \\ 
  Robert Morris & Robert Morris Univ & JMI Labs & JMI Laboratories \\ 
  U Cincinnati & Univ of Cincinnati & Whitehead Inst & Whitehead Institute of Biomedical Research \\ 
  Case Western & Case Western Reserve Univ & Wellesley & Wellesley Univeristy \\ 
  Ashland & Ashland Univ & UT Health, San Antonio & Univ of Texas Health Science Center, San Antonio \\ 
  Texas A\&M & Texas A\&M Univ-Commerce & UNT & Univ of North Texas \\ 
  Texas Southern & Texas Southern Univ & UT Southwestern Med & Univ of Texas Southwestern Medical Center \\ 
  Baylor & Univ of Mary Hardin-Baylor & UT El Paso & Univ of Texas, El Paso \\ 
  U Washington & Univ of Washington - Seattle & USF & Univ of South Florida, Tampa \\ 
  Washington State & Washington State Univ & Florida A\&M & Florida Agricultural and Mechanical Univ \\ 
  Seattle Pacific & Seattle Pacific Univ & Barry & Barry Univ \\ 
  Cal State Fresno & California State Univ-Fresno & UMass Dartmouth & Univ of Massachusetts Dartmouth \\ 
  Northern Arizona & Northern Arizona Univ & Worcester Poly & Worcester Polytechnic Institute \\ 
  IUPUI & Indiana Univ - Purdue Univ Indianapolis & Umass Boston & Univ of Massachusetts Boston \\ 
  U Dayton & Univ of Dayton & MGH Inst & MGH Institute of Health Professions \\ 
  U Conn & Univ of Connecticut & Joseph W. Jones Center & Joseph W. Jones Ecological Research Center \\ 
  ASU & Arizona State Univ & Vaccine Research Center & Vaccine Research Center, San Diego \\ 
  U Florida & Univ of Florida & LA Ag Center & Lousianna Agricultural Center \\ 
  Northern Illinois & Northern Illinois Univ & FL Fish and Wildlife & Florida Fish and Wildlife Conservation Commission \\ 
  Condordia Chicago & Concordia Univ-Chicago & NHLBI & Natl Heart, Lung, and Blood Institute \\ 
  U Chicago & Univ of Chicago & NY Dept. of Health & New York Department of Health \\ 
  SIU Edwardsville & Southern Illinois Univ, Edwardsville & St Michaels & Saint Michaels College \\ 
  SIU Carbondale & Southern Illinois Univ, Carbondale &  &  \\ 
   \hline
\end{tabular}
\endgroup
\end{adjustwidth}
\end{table}


\newpage
%
% Figure - publications over time
%
\begin{figure}[p!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/Descriptive/pubs_over_time.pdf}
	\caption{
		\textbf{Publications over time.}
		\textbf{a.}
		The number of papers published by mobile authors has been steadily increasing from 2008 to 2017, with a small decrease in 2018,  likely an artifact of the Web of Science indexing process.
		Lines corresponds to publications by mobile authors (org, purple), by authors with affiliations in at least two cities (blue), at least two regions (green), and at least two countries (yellow).
		There is no evidence of major changes in publication patterns of mobile authors during this time period.
		\textbf{b.}
		Lines correspond to the proportion of publications classified as Biology and Health (black), Physics and Engineering (purple), Life and Earth Science (magenta), Social Science and Humanities (orange), and Math and Computer Science (yellow).
		The rate of publication in Biology and Health has leveled since about 2013, whereas the rate of publication in other fields has steadily increased.
		\textbf{c.}
		Despite increasing absolute counts, the percentage of mobile scholars, and those with at least two city, regional, or country affiliations, as a proportion of all publications, has decreased over time.
		\textbf{d.}
		The proportion of authors publications across fields has largely remained steady.
		Biology and Health Science has comprised the majority of publications across nearly all years, but has steadily declined in proportion.
		However, the proportion of Social Science and Humanities publications has been steadily increasing.
	}
	\label{fig:supp:pubs_over_time}
\end{figure}


%
% Figure - descriptives
%
\begin{figure}[p!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/Descriptive/mobility_by_country.pdf}
	\caption{
		\textbf{Extent and nature of mobility by country.}
		\textbf{a.}
		Proportion of researchers in each country classified as mobile, meaning that they have at least two organization affiliations within the period of study.
		The countries with the most mobile researchers are the United States, China, France, Great Britain, and Germany.
		\textbf{b.}
		The same information, arranged into a cumulative distribution.
		The five countires with the highest mobility account for approximately 70 percent of all mobility.
		\textbf{c.} The proportion of researchers labeled as mobile by country.
		\textbf{d.} First two principal components of four variables: proportion in each country mobile across organizations, proportion mobile across cities, proportion mobile across regions, and proportion mobile across countries.
		First component captures overall degree of mobile, whereas the second compares within-country against across-country mobility.
	}
	\label{fig:supp:descriptives}
\end{figure}


\newpage
%
% Figure - reverse CDF by scale
%
\begin{figure}[p!]
	\centering
	\includegraphics[width=0.8\textwidth]{\figdir/Descriptive/rcdf_by_scale.pdf}
	\caption{
		\textbf{Reverse cumulative-distribution function of mobile authors by geographic scale.}
		\textbf{a.}
		Proportion of mobile authors by how many organizations are represented 	in their career trajectories.
		For example, for mobile authors, 100 percent of authors held an affiliation with at least two organizations, whereas about 35 percent were affiliated with 3 ore more organizations between 2008 and 2019.
		Mobile authors are defined as those with at least two distinct organizational affiliations represented in our data.
		\textbf{b.} 68 percent of mobile authors have at least two cities represented in their career trajectories.
		\textbf{c.} 45 percent of mobile authors have 2 or more regions represented in their career trajectories.
		\textbf{d.} Only 14 percent of mobile authors had 2 or more countries represented in their career trajectories.
	}
	\label{fig:supp:rcdf_by_scale}
\end{figure}



%
% Figure - Hyperparameter performance
%
\begin{figure}[p!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/Descriptive/hyperparameter_performance.pdf}
	\caption{
		\textbf{Larger dimensions, smaller window size improves embedding performance.}
		The correlation, or amount of flux explained by the embedding distance with varying skip-gram negative sampling hyperparameters.
		Window size refers to the window, on either side of the target token, to use as context for training.
		Smaller window sizes results in an embedding that explain more of the flux.
		Embedding dimensions refer to the size of the organization vector.
		Larger vectors perform better, though little difference between 200 and 300.
		All variants perform better on same-country pairs of organizations than on all organizations.
		All variants perform worse on different-country pairs on organizations.
		Larger embeddings outperform mid-size embeddings for the different-country case.
	}
	\label{fig:supp:hyperparams}
\end{figure}


%
% Figure - Geographic predictions, by model
%
\begin{figure}[p!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/GravityLawFig/gravity_performance_geo_bymodel.pdf}
	\caption{
		\textbf{For geographic distance, the power-decay gravity model is better.}
		Predictions of flux between organization pairs made using geographic distance the exponential gravity model (top), and the power-law decay model (bottom). 
		Boxplots show distribution of actual flux for binned values of predicted flux.
		Box color corresponds to the degree to which the distribution overlaps $x = y$.
		Shown using all pairs of organization (\textbf{a-b}), domestic (\textbf{c-d}), and international only (\textbf{e-f}) mobility. 
		The power-decay model outperforms the exponential gravity model.
	}
	\label{fig:supp:predict_geo_bymodel}
\end{figure}



%
% Figure - Embedding predictions, by model
%
\begin{figure}[p!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/GravityLawFig/gravity_performance_emb_bymodel.pdf}
	\caption{
		\textbf{For embedding distance, the exponential gravity model is better.}
		Predictions of flux between organization pairs made using embedding distance the exponential gravity model (top), and the power-law decay model (bottom). 
		Boxplots show distribution of actual flux for binned values of predicted flux.
		Box color corresponds to the degree to which the distribution overlaps $x = y$.
		Shown using all pairs of organization (\textbf{a-b}), domestic (\textbf{c-d}), and international only (\textbf{e-f}) mobility. 
		The exponential gravity model out-performs the power-decay model. 
	}
	\label{fig:supp:predict_emb_bymodel}
\end{figure}



%
% Figure - gravity correlation
%
\begin{figure}[p!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/GravityLawFig/gravity_correlations.pdf}
	\caption{
		\textbf{Embedding distance explains more variance for global, within, and between country flux than geographic distance.}
		\textbf{a.}
		Embedding distance (cosine distance between vectors) explains more of the total distance than does geographic distance (\textbf{b}).
		Red line is line of best fit.
		Black dots are mean flux across binned distances.
		Color indicates frequency of organization pairs within each hex bin.
		Results here are identical to those shown in Fig.~\ref{fig:gravity_performance}a and Fig.~\ref{fig:gravity_performance}.
		\textbf{c-d.}	embedding distance explains more variance when considering only pairs of organizations within the same country.
		\textbf{e-f.} embedding distance is more robust than geographic distance for pairs of organizations in different countries.
	}
	\label{fig:supp:gravity_correlation}
\end{figure}



%
% Figure - gravity predictions based on subset or global
%
\begin{figure}[p!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/GravityLawFig/gravity_different_fits.pdf}
	\caption{
		\textbf{Little difference between gravity predictions fit on all or subsets of data.}
		Predictions of flux between organization pairs made using embedding distance out-performs those made using geographic distance.
		Boxplots show distribution of actual flux for binned values of predicted flux.
		Box color corresponds to the degree to which the distribution overlaps $x = y$.
		\textbf{a-b.} Predictions are made with parameter, estimating parameters from all pairs of organizations, making global predictions (as in Fig.~\ref{fig:gravity_performance}c), and showing only subsets of predictions for organization pairs in the same country (\textbf{a}) and in different countries (\textbf{b}).
		\textbf{c-d.} Predictions made by estimating gravity law parameters on subset of organizations in the same country (\textbf{c}) and different country \textbf{d});
		this is the same data as shown in Fig.~\ref{fig:gravity_performance}f and Fig.~\ref{fig:gravity_performance}h.
	}
	\label{fig:supp:gravity_prediction_subsets}
\end{figure}


%
% Figure - PPR with COSINE DISTANCE gravity model and predictions
%
\begin{figure}[p!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/GravityLawFig/gravity_pprcos.pdf}
	\caption{
		\textbf{Personalized page rank with cosine distance.}
		Performance of personalized page rank scores in explaining and predicting mobility.
		Personalized page rank is calculated for the underlying mobility network, and distance measured as the cosine distnace between PPR probability distribution vectors.
		PPR cosine distance performs roughly similar to geographic distance in explaining global mobility (\textbf{a}), or domestic (\textbf{b}) or international (\textbf{c}) country mobility.
		Red line is line of best fit.
		Black dots are mean flux across binned distances.
		Color indicates frequency of organization pairs within each hex bin.
		Similarly, PPR distance performs comparably to geographic distance in predicting global (\textbf{d}), domestic (\textit{e}) and international (\textbf{f}) scientific mobility.
		Boxplots show distribution of actual flux for binned values of predicted flux.
		Box color corresponds to the degree to which the distribution overlaps $x = y$.
	}
	\label{fig:supp:gravity_pprcos}
\end{figure}


%
% Figure - PPR with JSD gravity model and predictions
%

\begin{figure}[p!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/GravityLawFig/gravity_pprjsd.pdf}
	\caption{
		\textbf{Personalized page rank with Jensen-Shannon Divergence.}
		Performance of personalized page rank scores in explaining and predicting mobility.
		Personalized page rank is calculated for the underlying mobility network, and distance measured as the Jensen-Shannon Divergence (JSD) between PPR probability distribution vectors.
		PPR JSD performs roughly similar to geographic distance in explaining global mobility (\textbf{a}), or domestic (\textbf{b}) or international (\textbf{c}) country mobility.
		Overall, PPR JSD explains more vairance in mobility than using cosine distance (Fig.~\ref{fig:supp:gravity_pprcos}), except for international mobility, for which cosine similarity out-performs JSD.
		Red line is line of best fit.
		Black dots are mean flux across binned distances.
		Color indicates frequency of organization pairs within each hex bin.
		Similarly, PPR JSD performs comparably to geographic distance in predicting global (\textbf{d}), domestic (\textit{e}) and international (\textbf{f}) scientific mobility.
		Boxplots show distribution of actual flux for binned values of predicted flux.
		Box color corresponds to the degree to which the distribution overlaps $x = y$.
	}
	\label{fig:supp:gravity_pprjsd}
\end{figure}


%
% Figure - New York Projection
%
\begin{figure}[hp!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/Projection/umap_coordinate_region_New_York.pdf}
	\caption{
		\textbf{UMAP Projection of organizations in New York.}
		Each point corresponds to an organization and its size indicates the average annual number of mobile and non-mobile authors affiliated with that organization from 2008 to 2019. 
		Color indicates the sector. 
	}
	\label{fig:supp:proj_newyork}
\end{figure}


%
% Figure - Pennsylvania Projection
%
\begin{figure}[hp!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/Projection/umap_coordinate_region_Pennsylvania.pdf}
	\caption{
		\textbf{UMAP Projection of organizations in Pennsylvania.}
		UMAP projection of the embedding space of organizations in Pennsylvania reveal clustering based on geography, sector, and academic prestige.
		Each point corresponds to an organization and its size indicates the average annual number of mobile and non-mobile authors affiliated with that organization from 2008 to 2019. 
		Color indicates the sector. 
	}
	\label{fig:supp:proj_pennsylvania}
\end{figure}


%
% Figure - Texas Projection
%
\begin{figure}[hp!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/Projection/umap_coordinate_region_Texas.pdf}
	\caption{
		\textbf{UMAP Projection of organizations in Texas.}
		Each point corresponds to an organization and its size indicates the average annual number of mobile and non-mobile authors affiliated with that organization from 2008 to 2019. 
		Color indicates the sector. 
	}
	\label{fig:supp:proj_texas}
\end{figure}



%
% Figure - California Projection
%
\begin{figure}[hp!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/Projection/umap_coordinate_region_California.pdf}
	\caption{
		\textbf{UMAP Projection of organizations in California.}
		Each point corresponds to an organization and its size indicates the average annual number of mobile and non-mobile authors affiliated with that organization from 2008 to 2019. 
		Color indicates the sector. 
	}
	\label{fig:supp:proj_california}
\end{figure}




%
% Figure - SemAxis results
%
\begin{figure}[hp!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/SemAxis/semaxis_compare_fig.pdf}
	\caption{
		\textbf{SemRank hierarchy is robust.}
		\textbf{a.} Spearman correlation (n = 143) between Times prestige rank and SemAxis rank, by the number of high and bottom-ranked (geographically matched) universities aggregated to form the poles.
		Black points show spearman correlation using all organizations; white points show correlation using only universalizes not aggregated in the poles. 
		More universities improves performance, but quickly saturates after around five universities.
		\textbf{b - f.} Comparison between the Times and SemAxis ranks of universities, by number of universities used to define the poles (n).
		White points are those top and bottom 20 universities aggregated to define the ends of the axis.
		The grey box corresponds to the top 20 and bottom 20 ranks.
	  	PCC details the estimate from Spearman correlation between the two rankings.
	}
	\label{fig:supp:semaxis_compare}
\end{figure}


%
% Figure - Times Ranking vs. Leiden Ranking
%
\begin{figure}[hp!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/SemAxis/times_leiden_compare.pdf}
	\caption{
		\textbf{Correlation between Times and Leiden Ranking.}
		Comparison between the Times and Leiden rankings of universities.
		Here, the Leiden Ranking is operationalized as the mean normalized fractional citation impact for each university~\autocite{waltman2012leidenrankings}. 
	  	PCC details the estimate from Spearman correlation between the two rankings.
	}
	\label{fig:supp:times_vs_leiden}
\end{figure}



%
% Figure - SemAxis By State
%
\begin{figure}[hp!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/SemAxis/semaxis_states_fig.pdf}
	\caption{
		\textbf{Geography and prestige SemAxis by U.S. state.}
		SemAxis projection along two axes, comparing California to Massachusetts universities (left to right), and between the top 20 and geographically-matched bottom 20 universities ranked by the 2018 Times Higher Education ranking of U.S. Universities (bottom to top).
		Points correspond to universities shown for California (\textbf{a}), Arizona (\textbf{b}), Washington (\textbf{c}), Massachusetts (\textbf{d}), Connecticut (\textbf{e}), New York (\textbf{f}), Texas (\textbf{g}), Pennsylvania (\textbf{h}), and Florida (\textbf{i}).
		Grey points correspond to all other U.S. universities.
		Full organization names listed in Table~\ref{table:supp:orglabels}.
	}
	\label{fig:supp:semaxis_states}
\end{figure}


%
% Figure - SemAxis By Sector
%
\begin{figure}[hp!]
	\centering
	\includegraphics[width=\textwidth]{\figdir/SemAxis/semaxis_sectors_fig.pdf}
	\caption{
		\textbf{Geography and prestige SemAxis in U.S. by Sector.}
		SemAxis projection along two axes, comparing California to Massachusetts universities (left to right), and between the top 20 and geographically-matched bottom 20 universities ranked by the 2018 Times Higher Education ranking of U.S. Universities (bottom to top).
		Points correspond to organizations labeled as Government (\textbf{a}), Institute (\textbf{b}), and Teaching (\textbf{c}), corresponding to government organizations, research institutes, and teaching organizations, respectively.
		Grey points correspond to all U.S. universities.
	    	Full organization names listed in Table~\ref{table:supp:orglabels}.
	}
	\label{fig:supp:semaxis_sectors}
\end{figure}




\clearpage
\printbibliography{}

\end{document} %}}}

